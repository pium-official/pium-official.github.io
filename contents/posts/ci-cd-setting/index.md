---
title: "Jenkinsì™€ Github Webhookì„ ì´ìš©í•´ CI/CD êµ¬ì¶•í•˜ê¸°"
description: "ì  í‚¨ìŠ¤ì™€ Github Webhookì„ ì´ìš©í•œ CI/CD êµ¬ì¶• ë°©ë²•"
date: 2023-07-24
update: 2023-07-24
tags:
- CI/CD
- ì  í‚¨ìŠ¤
- Webhook
- ì„¤ì •
---

> ì´ ê¸€ì€ ìš°í…Œì½” í”¼ì›€íŒ€ í¬ë£¨ '[ê·¸ë ˆì´](https://github.com/Kim0914)'ê°€ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.

ì´ë²ˆ í”¼ì›€ ì„œë¹„ìŠ¤ì—ì„œ CI/CDë¥¼ ì ìš©í•˜ê¸° ìœ„í•´ Jekinsì™€ Github Webhookì„ ì´ìš©í–ˆìŠµë‹ˆë‹¤.



ë³¸ ê¸€ì—ì„œëŠ” Jenkinsì™€ Github Webhookì„ ì´ìš©í•œ SpringBoot ì„œë²„ ìë™ ë¹Œë“œ, ìë™ ë°°í¬ ê³¼ì •ì„ ë‹¤ë£¨ê² ìŠµë‹ˆë‹¤.



Jenkins ì„¤ì¹˜ ê³¼ì •ì€ [í”¼ì›€ íŒ€ ì  í‚¨ìŠ¤ ì„¤ì¹˜í•˜ê¸°](https://pium-official.github.io/jenkins-setting/) ë¥¼ ì°¸ê³ í•˜ì‹œë©´ ë©ë‹ˆë‹¤ !



ì‘ì—… í™˜ê²½

- ì¸ìŠ¤í„´ìŠ¤: AWS EC2 t4g.small
- OS: Ubuntu 22.04.2 LTS
- RAM: 2GB


## Jenkins ì ‘ì†
ì  í‚¨ìŠ¤ë¥¼ ì ‘ì†í•˜ëŠ” ë°©ë²•ì€ ê°„ë‹¨í•©ë‹ˆë‹¤. ì  í‚¨ìŠ¤ë¥¼ ì„¤ì¹˜í•œ ì¸ìŠ¤í„´ìŠ¤ public IPì™€ portë¥¼ ì£¼ì†Œì°½ì— ì…ë ¥í•˜ë©´ ì‰½ê²Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.



ì •ìƒì ìœ¼ë¡œ ì ‘ì†í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ í™”ë©´ì„ ë§Œë‚˜ê²Œ ë©ë‹ˆë‹¤.
![](.index_images/img.png)

---

## Github Webhook ì„¤ì •
ë¨¼ì € Webhookì„ ì„¤ì •í•˜ê¸° ìœ„í•´ í˜„ì¬ í”„ë¡œì íŠ¸ì˜ ê¹ƒí—ˆë¸Œ ë ˆí¬ì§€í† ë¦¬ë¡œ ì´ë™í•©ë‹ˆë‹¤.



ë ˆí¬ì§€í† ë¦¬ì˜ Settingsë¥¼ ëˆŒëŸ¬ì„œ ì ‘ì†í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´í›„ ì™¼ìª½ ë©”ë‰´ë°”ì— Webhooksë¥¼ ëˆ„ë¥´ë©´ ì•„ë˜ì™€ ê°™ì€ í™”ë©´ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
![](.index_images/img_1.png)

ì˜¤ë¥¸ìª½ ìƒë‹¨ì˜ Add Webhook ë²„íŠ¼ì„ ëˆŒëŸ¬ webhookì„ ì¶”ê°€í•˜ëŠ” í™”ë©´ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.



ê·¸ëŸ¬ë©´ ì•„ë˜ì™€ ê°™ì€ Payload URL, Content Type, Secretì„ ì…ë ¥í•˜ëŠ” í¼ì´ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.
![](.index_images/img_2.png)

**Payload URL**ì€ ì  í‚¨ìŠ¤ê°€ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” ì„œë²„ì˜ `ë„ë©”ì¸ ì£¼ì†Œ:í¬íŠ¸/github-webhook/` ì„ ì…ë ¥í•©ë‹ˆë‹¤.

ì  í‚¨ìŠ¤ì˜ ê¸°ë³¸ í¬íŠ¸ëŠ” 8080ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

ì£¼ì†Œ ë§ˆì§€ë§‰ì— / ëŠ” ê¼­ ë„£ì–´ì£¼ì…”ì•¼ í•©ë‹ˆë‹¤.

/ë¥¼ ë„£ì§€ ì•Šìœ¼ë©´ redirect URLë¡œ ì¸ì‹í•´ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.



**Content-type**ì€ `application/json`ì„ ì„ íƒí•©ë‹ˆë‹¤.



Secretì€ ë¹„ì›Œë‘ë©´ ë©ë‹ˆë‹¤.



ë§ˆì§€ë§‰ìœ¼ë¡œ ì–´ë–¤ ë™ì‘ì—ì„œ webhookì„ ë°œìƒì‹œí‚¬ì§€ ì„ íƒí•˜ë©´ ë©ë‹ˆë‹¤.

ì €í¬ íŒ€ì˜ ê²½ìš°ì—ëŠ” **Let me select individual events**ë¥¼ ëˆŒëŸ¬ **push**ì™€ **pull request**ê°€ ë°œìƒí–ˆì„ ë•Œ webhookì´ ë™ì‘í•˜ë„ë¡ ì„ íƒí–ˆìŠµë‹ˆë‹¤.



ëª¨ë“  ì„ íƒì„ ë§ˆì¹œ í›„ **Add webhook ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ í† í°ì´ ë°œí–‰**ë©ë‹ˆë‹¤.



í† í°ì„ ìƒì„±í•  ë•Œ í† í° ê¶Œí•œë„ í•¨ê»˜ ì„¤ì •í•  ìˆ˜ ìˆëŠ”ë°, ì´ ë•Œ repoì™€ admin:repo_hookì„ ì„ íƒí•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.



ë§Œì•½ CIë¥¼ í†µí•´ PRì— commentë¥¼ ë‚¨ê¸°ëŠ” ë“±ì˜ writeê°€ í•„ìš”ì—†ëŠ” ê²½ìš°ì—ëŠ” wirte ê¶Œí•œì„ ë¹¼ì¤„ ìˆ˜ ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.



í•´ë‹¹ í† í°ì€ ìƒì„± í›„ ì¬ë°œí–‰ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë”°ë¡œ ë³´ê´€ì„ í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

---

## Credentials ìƒì„±
ë‹¤ì‹œ ì  í‚¨ìŠ¤ í™”ë©´ìœ¼ë¡œ ì´ë™í•´ì„œ Credentialsë¥¼ ë“±ë¡í•˜ì—¬ Github webhookì„ ì—°ë™ ì‹œì¼œì•¼ í•©ë‹ˆë‹¤.



ì  í‚¨ìŠ¤ ë©”ì¸ í™”ë©´ì—ì„œ Jenkins ê´€ë¦¬ í˜ì´ì§€ë¡œ ì ‘ì†í•˜ë©´ Security íƒ­ì— Credentialsë¥¼ ëˆŒëŸ¬ ì ‘ì†í•©ë‹ˆë‹¤.
![](.index_images/img_3.png)

Add Credentialsë¥¼ ëˆ„ë¦…ë‹ˆë‹¤.
![](.index_images/img_4.png)

ê·¸ëŸ¬ë©´ ì•„ë˜ì™€ ê°™ì€ í™”ë©´ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.



ê¹ƒí—ˆë¸Œ webhookì—ì„œ ë°œê¸‰ë°›ì€ í† í°ì„ ì´ìš©í•´ í¬ë¦¬ë´ì…œ ê°’ì„ ìƒì„±í•©ë‹ˆë‹¤.
![](.index_images/img_5.png)

**kind**ëŠ” `Username with password`ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.



**username**ì—ëŠ” ê¹ƒí—ˆë¸Œ í† í°ì„ ë°œê¸‰ë°›ì€ `ê¹ƒí—ˆë¸Œ ì•„ì´ë””`ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.



**password**ì—ëŠ” `í•´ë‹¹ í† í° ê°’`ì„ ë„£ìœ¼ë©´ ë©ë‹ˆë‹¤.



**ID**ëŠ” ì  í‚¨ìŠ¤ì—ì„œ ì´ **í¬ë¦¬ë´ì…œì„ ì‹ë³„í•˜ê¸° ìœ„í•œ ì´ë¦„ì´ë¯€ë¡œ í¬ê²Œ ì˜ë¯¸ê°€ ì—†ëŠ” ê°’** ì…ë‹ˆë‹¤.

---

### Gradle ì„¤ì •
í˜„ì¬ ìš°ë¦¬ íŒ€ì€ ìŠ¤í”„ë§ ë¶€íŠ¸ ì„œë²„ë¥¼ ë¹Œë“œí•˜ê¸° ë•Œë¬¸ì— gradleì´ ë°˜ë“œì‹œ í•„ìš”í•©ë‹ˆë‹¤.



ì  í‚¨ìŠ¤ ë©”ì¸ í™”ë©´ì—ì„œ ëŒ€ì‹œë³´ë“œ -> ì  í‚¨ìŠ¤ ê´€ë¦¬ -> Toolsë¥¼ ëˆ„ë¥´ë©´ ì•„ë˜ì™€ ê°™ì€ Gradle ì„¤ì • í™”ë©´ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
![](.index_images/img_6.png)

Gradle 8.2.1 ë²„ì „ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.

ì¶”ê°€ë¥¼ ì™„ë£Œí•˜ê³  ë°”ë¡œ í˜ì´ì§€ë¥¼ ë‚˜ê°€ë©´ ì•ˆë©ë‹ˆë‹¤.

ê°€ì¥ ì•„ë˜ì— ìˆëŠ” íŒŒë€ìƒ‰ save ë²„íŠ¼ì„ ëˆŒëŸ¬ì•¼ í•´ë‹¹ ì„¤ì •ì´ ì €ì¥ë©ë‹ˆë‹¤ !!



Gradle ì„¤ì •ê¹Œì§€ ë§ˆì¹˜ë©´ ë¹Œë“œí•  ì¤€ë¹„ë¥¼ ëª¨ë‘ ë§ˆì³¤ìŠµë‹ˆë‹¤.



ì´ì œ CIë¥¼ ìë™ìœ¼ë¡œ ì‹¤í–‰í•˜ê¸° ìœ„í•´ì„œëŠ” CI ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.

---

## CI ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
ë“œë””ì–´ CIë¥¼ ë‹´ë‹¹í•˜ëŠ” ì  í‚¨ìŠ¤ ì•„ì´í…œì„ ìƒì„±í•  ì‹œê°„ì…ë‹ˆë‹¤ !



ëŒ€ì‹œë³´ë“œì—ì„œ New Itemì„ ëˆ„ë¥´ë©´ ì•„ë˜ì™€ ê°™ì€ í™”ë©´ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
![](.index_images/img_7.png)

ìƒë‹¨ì— ì•„ì´í…œ ì´ë¦„ì„ ì„¤ì •í•˜ê³  Pipelineì„ êµ¬ì¶•í•  ê²ƒì´ê¸° ë•Œë¬¸ì— Pipelineì„ ì„ íƒí•˜ê³  OKë¥¼ ëˆ„ë¦…ë‹ˆë‹¤.



ì´í›„ ì•„ë˜ì™€ ê°™ì´ ì•„ì´í…œì„ ì„¤ì •í•  ìˆ˜ ìˆëŠ” í™”ë©´ì´ ë‚˜ì˜µë‹ˆë‹¤.
![](.index_images/img_8.png)

ì €í¬ëŠ” ê¹ƒí—ˆë¸Œ í”„ë¡œì íŠ¸ë¥¼ ì‚¬ìš©í•˜ê³  ìˆê¸° ë•Œë¬¸ì— Github Projectë¥¼ ì²´í¬í•œ í›„ ë ˆí¬ì§€í† ë¦¬ì˜ urlì„ ì…ë ¥í•©ë‹ˆë‹¤.



ë‹¤ìŒìœ¼ë¡œ Build Triggerë¥¼ ì„ íƒí•´ì•¼í•˜ëŠ”ë°, Github webhookì„ ì‚¬ìš©í•  ê³„íšì´ë¯€ë¡œ Github hook triger for GITScm pollingì„ ì„ íƒí•©ë‹ˆë‹¤. í•´ë‹¹ ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ì•„ë˜ì— ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ëŠ” ì¹¸ì´ ë‚˜ì˜µë‹ˆë‹¤.
![](.index_images/img_9.png)



Scriptì¹¸ì— íŒ€ì—ì„œ í•„ìš”ë¡œ í•˜ëŠ” CI Scriptë¥¼ ì…ë ¥í•˜ë©´ ë©ë‹ˆë‹¤.



ì—¬ê¸°ì„œ ì €ì¥ ë²„íŠ¼ ìœ„ì— ë³´ì´ëŠ” Pipeline Syntaxë¥¼ ëˆ„ë¥´ë©´ ê¹ƒí—ˆë¸Œë¥¼ ì´ìš©í•´ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ìƒì„±í•˜ëŠ” í™”ë©´ì´ ë‚˜ì˜µë‹ˆë‹¤.
![](.index_images/img_10.png)

Sample Stepì„ Gitìœ¼ë¡œ ì„¤ì •í•œ í›„ ì•„ë˜ì— ê°’ì„ ì…ë ¥í•˜ë©´ ë©ë‹ˆë‹¤.



Credentialsì—ëŠ” ì¢€ ì „ì— ìƒì„±í–ˆë˜ í¬ë¦¬ë´ì…œì„ ì„ íƒí•˜ë©´ ë©ë‹ˆë‹¤. í•´ë‹¹ ì •ë³´ì— í† í° ê°’ì´ ìˆê¸° ë•Œë¬¸ì— ì •í™•í•œ í¬ë¦¬ë´ì…œì„ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤.

í¬ë¦¬ë´ì…œì€ ìƒì„±í•  ë•Œ ì…ë ¥í•œ IDì™€ ë™ì¼í•˜ê²Œ ë³´ì—¬ì§‘ë‹ˆë‹¤.



ëª¨ë‘ ì…ë ¥í–ˆë‹¤ë©´ Generate Pipeline Scriptë¥¼ ëˆŒëŸ¬ ì™„ì„±ëœ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.



í•´ë‹¹ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë§Œë“œëŠ” ì´ìœ ëŠ” ë¹Œë“œ ê³¼ì •ì—ì„œ Github ì €ì¥ì†Œì—ì„œ ì €ì¥ì†Œë¥¼ ë³µì œí•´ì•¼í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ê·¸ëŸ¬ë¯€ë¡œ ì €ì¥ì†Œì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œì´ ë°˜ë“œì‹œ í•„ìš”í•©ë‹ˆë‹¤.



ì „ì²´ ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

```shell
pipeline {
    agent any
    tools {
        gradle 'gradle'
    }
    triggers {
        githubPush()
    }
    stages {
        stage('ì €ì¥ì†Œ ë³µì œ') {
            steps {
                // ì—¬ê¸°ì„œ ë°©ê¸ˆ ìƒì„±ëœ ê¹ƒí—ˆë¸Œ ìŠ¤í¬ë¦½íŠ¸ ë„£ê¸°
        }
        
        stage('ë¹Œë“œ') {
            steps {
                sh '''
                cd backend/pium
                ./gradlew clean build
                '''
            }
            post {
                failure {
                    slackSend (
                        channel: '#ì•Œë¦¼-ì  í‚¨ìŠ¤',
                        color: '#FF0000',
                        message: "ë°±ì—”ë“œ Build ì‹¤íŒ¨...ğŸ˜¢"
                    )
                }
            }
        }
    }
}
```


stagesì—ì„œ ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œì— ìˆëŠ” í”„ë¡œì íŠ¸ë¥¼ ê°€ì ¸ì˜¨ í›„, ë³¸ì¸ì˜ í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ë¡œ ì´ë™í•´ buildë¥¼ ì§„í–‰í•˜ë„ë¡ í•˜ë©´ ë©ë‹ˆë‹¤.

ë””ë ‰í† ë¦¬ë¥¼ ì˜®ê¸°ëŠ” ë¶€ë¶„ì—ì„œ ëª‡ ë²ˆ ì—ëŸ¬ê°€ ìˆì—ˆëŠ”ë°, Jenkins ëŒ€ì‹œë³´ë“œì˜ Console Outputì„ ì´ìš©í•´ ë””ë²„ê¹…í•˜ë©´ì„œ ìˆ˜ì •í•´ë‚˜ê°€ë©´ ì‰½ê²Œ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.



ì§€ê¸ˆê¹Œì§€ ì˜¬ë°”ë¥´ê²Œ ì ìš©ë˜ì—ˆë‹¤ë©´ CI ì„¤ì •ì€ ëª¨ë‘ ì •ìƒì ìœ¼ë¡œ ë§ˆì³¤ìŠµë‹ˆë‹¤.



ë‹¤ìŒìœ¼ë¡œ CD(ìë™ ë°°í¬) ì„¤ì • ë°©ë²•ì„ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

---

## SSH Agent ì„¤ì¹˜
í˜„ì¬ ë¹Œë“œ ì„œë²„ì™€ ìš´ì˜ ì„œë²„ê°€ ì„œë¡œ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ë¡œ ë¶„ë¦¬ë˜ì–´ ìˆê¸° ë•Œë¬¸ì—, ì  í‚¨ìŠ¤ ë¹Œë“œ ì„œë²„ì—ì„œ ë¹Œë“œí•œ íŒŒì¼ì„ ìš´ì˜ì„œë²„ë¡œ ì „ë‹¬í•´ì•¼

í•©ë‹ˆë‹¤. ì´ë•Œ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ë¡œì˜ ì ‘ì†ì´ í•„ìš”í•˜ë¯€ë¡œ SSH ì—°ê²° ì„¤ì •ì„ í•´ì•¼ í•©ë‹ˆë‹¤.



ê¸°ì¡´ì˜ ë¸”ë¡œê·¸ë‚˜ ì—¬ëŸ¬ ë ˆí¼ëŸ°ìŠ¤ë¥¼ ì°¾ì•„ë³´ë©´ Publish Over SSHë¥¼ ë§ì´ ì‚¬ìš©í•˜ëŠ”ë°, í˜„ì¬ ì ‘ì† ë¶ˆê°€ ì´ìŠˆê°€ ìˆìŠµë‹ˆë‹¤.

ê·¸ëŸ¬ë¯€ë¡œ SSH Agentë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.



Jenkins ê´€ë¦¬ì˜ Plugin íƒ­ì„ ë“¤ì–´ê°€ì„œ ì„¤ì¹˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.



Jenkinsë„ í•˜ë‚˜ì˜ ì„œë²„ì—ì„œ ë™ì‘í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ìš´ì˜ì„œë²„ë¡œ ì ‘ì†í•˜ê¸° ìœ„í•œ pem í‚¤ê°€ í•„ìš”í•©ë‹ˆë‹¤.



ëŒ€ì‹œë³´ë“œ -> ì  í‚¨ìŠ¤ ê´€ë¦¬ -> Credentials ë¡œ ì´ë™í•©ë‹ˆë‹¤.



ê¹ƒí—ˆë¸Œ í¬ë¦¬ë´ì…œì„ ìƒì„±í•˜ëŠ” ê²ƒê³¼ ë™ì¼í•œ ë°©ë²•ìœ¼ë¡œ pem í‚¤ë¥¼ í¬ë¦¬ë´ì…œë¡œ ì„¤ì •í•©ë‹ˆë‹¤.
![](.index_images/img_11.png)

**kind**ëŠ” `SSH Username with private key`ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.



**id**ëŠ” ê¹ƒí—ˆë¸Œ í¬ë¦¬ë´ì…œê³¼ ë§ˆì°¬ê°€ì§€ë¡œ ì‹ë³„ìì´ê¸° ë•Œë¬¸ì— `ì›í•˜ëŠ” ê°’ì„` ì…ë ¥í•˜ë©´ ë©ë‹ˆë‹¤.



**username**ì€ ì¸ìŠ¤í„´ìŠ¤ì˜ HostName ex) ubuntu@123-345-678-23ì˜ `ubuntu` ë¥¼ ì…ë ¥í•˜ë©´ ë©ë‹ˆë‹¤.



ë§ˆì§€ë§‰ìœ¼ë¡œ **ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ë©´ì„œ ë°›ì•˜ë˜ pem í‚¤ë¥¼ Add ë²„íŠ¼ì„ ëˆŒëŸ¬ ì¶”ê°€**í•©ë‹ˆë‹¤.

pem í‚¤ì— ìˆëŠ” ëª¨ë“  ë‚´ìš©(Begin, End í¬í•¨)ì„ ë‹¤ ë³µì‚¬í•´ì„œ ë„£ì–´ì•¼í•©ë‹ˆë‹¤.

---

## CD ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
ì´ì œ ì  í‚¨ìŠ¤ê°€ ì„¤ì¹˜ëœ ì„œë²„ì—ì„œ ë¹Œë“œëœ ê²°ê³¼ë¬¼ì„ ìš´ì˜ ì„œë²„ë¡œ ì „ë‹¬í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.

ì´ë•Œ scp ë¼ëŠ” í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ì„ ì „ë‹¬í•©ë‹ˆë‹¤.



ì €í¬ íŒ€ì´ ì‚¬ìš©í•œ ìŠ¤í¬ë¦½íŠ¸ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

ë¹Œë“œ ì„±ê³µ ìœ ë®¤, ë°°í¬ ì„±ê³µ ìœ ë¬´ë¥¼ ìŠ¬ë™ê³¼ ì—°ë™í•´ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤ !

```shell
pipeline {
    agent any
    tools {
        gradle 'gradle'
    }
    triggers {
        githubPush()
    }
    stages {
        stage('ì €ì¥ì†Œ ë³µì œ') {
            steps {
                // ê¹ƒí—ˆë¸Œ í¬ë¦¬ë´ì…œ
            }
        }
        
        stage('ë¹Œë“œ') {
            steps {
                sh '''
                cd //í”„ë¡œì íŠ¸ ìœ„ì¹˜
                ./gradlew clean build
                '''
            }
            post {
                failure {
                    slackSend (
                        channel: '#ì•Œë¦¼-ì  í‚¨ìŠ¤',
                        color: '#FF0000',
                        message: "ë°±ì—”ë“œ Build ì‹¤íŒ¨...ğŸ˜¢"
                    )
                }
            }
        }
        stage('ë°°í¬') {
            steps {
                sshagent(credentials: ['pem í‚¤ë¡œ ìƒì„±í•œ í¬ë¦¬ë´ì…œ ID']) {
                    sh '''
                        cd //í”„ë¡œì íŠ¸ ìœ„ì¹˜
                        
                        ssh -o StrictHostKeyChecking=no {HostName}@{Private IP} uptime
                        cd build/libs
                        
                        scp {ë¹Œë“œëœ Jar íŒŒì¼ëª…} {HostName}@{Private IP}:/home/ubuntu
                        ssh -t {HostName}@{Private IP} {ìš´ì˜ì„œë²„ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼}
                    '''
                }
            }
            post {
                success {
                    slackSend (
                        channel: '#ì•Œë¦¼-ì  í‚¨ìŠ¤',
                        color: '#00FF00',
                        message: "ë°±ì—”ë“œ ë°°í¬ ì„±ê³µ! ğŸš€"
                    )
                }
                failure {
                    slackSend (
                        channel: '#ì•Œë¦¼-ì  í‚¨ìŠ¤',
                        color: '#FF0000',
                        message: "ë°±ì—”ë“œ ë°°í¬ ì‹¤íŒ¨ ğŸ¥²"
                    )
                }
            }
        }
    }
}
```


CI/CD ì„¤ì •ì„ ëª¨ë‘ ë§ˆì¹œ í›„ ê¹ƒí—ˆë¸Œ í”„ë¡œì íŠ¸ì— push, pull requestì™€ ê°™ì€ triggerê°€ ë°œìƒí•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ë¹Œë“œ ê²°ê³¼ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
![](.index_images/img_12.png)

### Reference
[ë² ë² ì˜ CI/CD ê¸€](https://developer-nyong.tistory.com/47#article-7-1--ssh-%ED%94%8C%EB%9F%AC%EA%B7%B8%EC%9D%B8-%EC%84%A4%EC%B9%98)
