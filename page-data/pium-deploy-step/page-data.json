{"componentChunkName":"component---src-templates-post-jsx","path":"/pium-deploy-step/","result":{"data":{"site":{"siteMetadata":{"title":"pium.log"}},"markdownRemark":{"id":"a78e224b-b711-5071-8e90-013d6f4bebc3","excerpt":"이 글은 우테코 피움팀 크루 '주노'가 작성했습니다. 서론  http://pium.life 로 접속하면 피움의 홈페이지가 나오기까지의 과정을 기록으로 남겨보려고 한다. 본 과정은 서버 구축을 처음 하면서 과정을 이해하기위해 작성된 글입니다. 빠르게 따라할 수 있는 설정 기반 글을 원한다면 마지막 목차인 정리를 확인해보시길 바랍니다. 본 과정에서는 소량의 …","html":"<blockquote>\n<p>이 글은 우테코 피움팀 크루 '<a href=\"https://github.com/Choi-JJunho\">주노</a>'가 작성했습니다.</p>\n</blockquote>\n<h2>서론</h2>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/f67e51b2131d2821f9e1581e6399b0fd/cc6c5/3162b98e.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 63.52941176470588%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaElEQVR42q2Sy04CMRSG22AcWZjxvnDjm2jkUVhD4A3IhDEZmNFouMUV7jQ+DmsgEF1puA3hkunl2FMYAwYJEv/kS9P2/H9P0xLTMGIHR/vOydl5xjSPLfPw1KKUWoSQNVANpRGLRgxrZ3cvE42ajmEY1ySbtb1q9QkKhTIvlSpQVHje3RKud6sJ507OBcfJwf1DEUrlR6iUK/zl+RVs+8Yl7XbbhZmmCrYl6AWVlSPNZtPDCVcSQgDCFwgYg7fRB7xPPiHgTK8JKWfM6xljHDPq9bpLWq2WDpRSclghbRAcBEj4TapGexuNxupANAuJHXIY+D70Bn3o9fvgD329hnuLB6wNVCMM2BgmItCM+RRGbKpHJFwfBmNdu1GHHLsLgR8s7G185b9qKTB85fnz4x3w7I34rheCzQPz/99hrVbLq38EnU6Hd7td2Ab0KoHKckg8Hr9IJBKxVCp1mUwmr7YBvel0OoZZX6UfYwEuhsjCAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='3162b98e' title='' src='/static/f67e51b2131d2821f9e1581e6399b0fd/ca1dc/3162b98e.png' srcset='/static/f67e51b2131d2821f9e1581e6399b0fd/e7570/3162b98e.png 170w,\n/static/f67e51b2131d2821f9e1581e6399b0fd/f46e7/3162b98e.png 340w,\n/static/f67e51b2131d2821f9e1581e6399b0fd/ca1dc/3162b98e.png 680w,\n/static/f67e51b2131d2821f9e1581e6399b0fd/02d09/3162b98e.png 1020w,\n/static/f67e51b2131d2821f9e1581e6399b0fd/9d567/3162b98e.png 1360w,\n/static/f67e51b2131d2821f9e1581e6399b0fd/cc6c5/3162b98e.png 1552w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p><a href=\"http://pium.life\">http://pium.life</a> 로 접속하면 피움의 홈페이지가 나오기까지의 과정을 기록으로 남겨보려고 한다.</p>\n<blockquote>\n<p>본 과정은 서버 구축을 처음 하면서 과정을 이해하기위해 작성된 글입니다.</p>\n<p>빠르게 따라할 수 있는 설정 기반 글을 원한다면 마지막 목차인 정리를 확인해보시길 바랍니다.</p>\n</blockquote>\n<blockquote>\n<p>본 과정에서는 소량의 과금(?)이 존재합니다.\n(도메인 구입비용 : 약 4000원)</p>\n</blockquote>\n<h2>도메인 정하기</h2>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/beeec2ef08bc2096e099db73407a0997/649dd/8e211be2.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 62.94117647058823%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACiUlEQVR42nVTy2oUQRTtP3Av+A0uXbj0P8SVG9FVNhFEyC8IQgQfRJCRCTGTSEBBg4Y8Jpk8hsRE0cwDM5OZnp7u6kdVV/XreKuSGSPEgsN9cOvUved2WwMmMAwUlJQIAx+CR/A919hRLuYcUggIwTF0bKRpgtHhAQMb9DDsdRAyD9bE7CGmvzSxsNfB/G4Hld0u3u2cGLuwd4r5nc7Yr+x1Mbf9G4v1Hhbqp1ja72Nyto470yu4+3wdE+V9WNcefsZU5QArRx2sNhhWj12sNTxjL/NH8fL3PjYaQ1x/9AHW7RKu3F/E1clPsDZbDFvtANWWj40mw3rTw3rjL9Y00Tl0rGtGqFJtre0bbLUZNls0stZJhAyZEkglR5ZI5BlplCdkM+TFWC5kpF0SR0hEBBlzcJUZrWMeIMtSU2PFUoH5AfwgRBCGiDiJH0tIpSAUEWS5Ic1zUC4BFzFBIEnowaJAnioDFDkohMVpg1EU0YWcXslog2cv6Qs61kcRufYLuqGSsw1X6n08KB9iaukXHr//iXulAyz/cGhkKtakuljS+BrmIuU1ucmTrx+UaYFGL6LZFTYbLp5+PER5o4m52glefG3iW8eHFQSB6ebi0SQjq72CdZF7XfoOBRYPXCwdeWZETjJJkigjKTIpjeaW4zimmzHBRbJzP7ePkdoNKFrEy2oPT9Zs0i2Bwzhcn34Mso5Hy5EJLM/1xrqNSP6BJhw0kfq22fDrWh/PqgMUtFVN5AUCjOD59DeplDocDmH7MeIku5zwnDQjDSPfxdsdGzPbLgpqIiQiEdHWCWEozgjtwQCcWlVpjv8dTci4BHP6mNnq41VtiBNf4sabJm6W2mRbuFVuw+UJ/gC7D8S+CPzx7gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='8e211be2' title='' src='/static/beeec2ef08bc2096e099db73407a0997/ca1dc/8e211be2.png' srcset='/static/beeec2ef08bc2096e099db73407a0997/e7570/8e211be2.png 170w,\n/static/beeec2ef08bc2096e099db73407a0997/f46e7/8e211be2.png 340w,\n/static/beeec2ef08bc2096e099db73407a0997/ca1dc/8e211be2.png 680w,\n/static/beeec2ef08bc2096e099db73407a0997/02d09/8e211be2.png 1020w,\n/static/beeec2ef08bc2096e099db73407a0997/649dd/8e211be2.png 1234w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<blockquote>\n<p>도메인을 구입하기 위해 도메인 호스팅 사이트 <a href=\"https://www.gabia.com/\">가비아</a>를 이용했다.</p>\n</blockquote>\n<p><code class=\"language-text\">pium.com</code> <code class=\"language-text\">pium.co.kr</code> <code class=\"language-text\">pium.net</code> 등등.\n서비스의 이름으로 자주 사용하는 도메인을 생성하고싶었으나 이미 존재하거나 가격이 너무 비싸다는 문제가 있었다.</p>\n<p>적당한 가격에 서비스의 이름을 가진 도메인인 <code class=\"language-text\">pium.life</code>를 선택했다. (1년 4000원)</p>\n<h2>도메인 설정하기</h2>\n<blockquote>\n<p>가비아 서비스를 기준으로 과정이 진행됩니다.</p>\n</blockquote>\n<p><code class=\"language-text\">3.123.123.123</code>과 같은 인스턴스 public ip 주소를 <code class=\"language-text\">pium.life</code>로 별칭을 지정해주자.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/5c39231cc02060595d5acd7d53964cac/89578/ce5d100b.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 61.76470588235294%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAC3UlEQVR42lWTW0hUaxiG/y72RUEbklFnpoNlZZoTmqlJjjnWzFgzzTgzGdmBbZmVHfCUVgTWZofEpg2F7U03QVHaibroKiKC7oIi6C7oJoqUHNtzaJzTmuU8/WvVGH3w8i6e7/v/9S74lghGU0xEUqRSSRLxGPHpGNOxKOlUglQyobNkMk46neJrNKz3tMpms7qr8lzw3VumPn4gHAkjXP1jbOkdxS19a98orr4xNOYZuIN38A4eXXfxnnqAR3J37008J27p3Dt4W7JRmvaNYDvwH/bj1xHz1p9iqXsYQ+MQZudfGO1/km8bYo6lB2HpQ1QMICpPSj/BnPoLzA085LdN1xCrjyDWdCPWDiKqTyOq+uWcpsA5Wnv+xXvsMs7Of6Qu4u66RP2eYRr+uEixa4jC5rPkWQco3DFG/U2ovaKSb79KXk0nhvoeDNZ+DBu6yZMSRQ2drGzqosxxjOW2w5jr9mOsbafI2smSjV2YrN0Un32Fpfs+q/deZ8VwhIp7UNT+ht9X+TDW7aOg7iD5dYfIr+1ALK7ejqWpnRLrbhauC2Ba68Nc5cdYKb16J8aKAEUtI/iegO38Uwr9j1h0BgoCz1lQ4qR01wjLmk9iqtmDuaYNYSptYLHFxqLyRoyrrD9VKlW2icISK8UbdmE5epuljl4Kyn3Mt44yr/wIhuXrMa/bi6mqDVOlH1NZI8LhbsXh2o59a0D3X9WK09OGu0X6Zid25zbJ/Njdfhzu7/3NrgC2lg4avR00NfsQweAkodD/+p4lEnFdSbmDipImoyi6p9Np6RkyGU3KLE9JDjP8/ew9jquvefw2iFDVDKqq/ljU7C+eW95c5ViOZ79DIokMU9MKYy/HERqLx+NMTgZlEmX2cDgcZmJiQiZOzLJQKMT4+Pgsm5mZYWrqC18mP6MqSW68+KQlVInFYkSjUf3iXBKNRSIR+dsldabIz9RmNKbN5ZJqz9qLtL5W3wA2so9kRrWVagAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='ce5d100b' title='' src='/static/5c39231cc02060595d5acd7d53964cac/ca1dc/ce5d100b.png' srcset='/static/5c39231cc02060595d5acd7d53964cac/e7570/ce5d100b.png 170w,\n/static/5c39231cc02060595d5acd7d53964cac/f46e7/ce5d100b.png 340w,\n/static/5c39231cc02060595d5acd7d53964cac/ca1dc/ce5d100b.png 680w,\n/static/5c39231cc02060595d5acd7d53964cac/02d09/ce5d100b.png 1020w,\n/static/5c39231cc02060595d5acd7d53964cac/89578/ce5d100b.png 1209w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>우측 상단의 <code class=\"language-text\">My 가비아</code> 탭으로 들어간다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/73e1f16d1334bd57f1a8ece74d6d0c21/9d8cf/48a0d2d6.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 60.58823529411765%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACBklEQVR42mVTy47TQBD0v3PkyA9w4Qf2ivbEhQMSBzisBAg22ayddfwYe94PF9WTRERLS5XxTHrcVdXtph0tfrYL+tmhVw4xZah5hrUWs1IwxmCaJnjvMQxDPb9GIYwPsCHi8anDrz97NFobhBhRNiDzxzMhci8wWnMNKKVU5Jzrum3bBXwuEdgykbgENCOrCiRZkpxzKHw+tEf8aKf6gtdRmCfxZa/x9n6Hd5+e8ea+w4evIxq1rHjpB8gaQqLkcpbN/aQ02ecKz//OiHA+VgIPncHd9wl33wa8/9zi48OApjsO2O0OWFbDxIR1tVi0ZZERXfcCxfNVO1gXK64v1saTwFluiQ4gUqBkY1w1XcwX41MiSyZqG3CaFlpgeTFUmSmXC8MAYx3MojEcWszzgmkxVUljXaiNyLlUOOfZiESWHt2w0EN6S78SGyZnO3bz9+OexVbYWeG022MdZwyzrlY02liMZLiuurIUiBSRFVnxNsSKp+cjdvsWx56qqKLvevpt0B5PcLzXWGEnI3FByqkytqwmuI2ZF4Vh250wkKFnQcfCwkwt0sAkDB1WdlRz5ix9kZkUjzwbJAm3odmc07jQ31jli6e3IXt66OsQXz2UuRMPRfKkFig112IS1qy0Z66zehnF/18o46L4ia28JN4V+VrYVZET0j8r5Fz2KZ+fX2MjxPO/QnGg8g4b/ygAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='48a0d2d6' title='' src='/static/73e1f16d1334bd57f1a8ece74d6d0c21/ca1dc/48a0d2d6.png' srcset='/static/73e1f16d1334bd57f1a8ece74d6d0c21/e7570/48a0d2d6.png 170w,\n/static/73e1f16d1334bd57f1a8ece74d6d0c21/f46e7/48a0d2d6.png 340w,\n/static/73e1f16d1334bd57f1a8ece74d6d0c21/ca1dc/48a0d2d6.png 680w,\n/static/73e1f16d1334bd57f1a8ece74d6d0c21/02d09/48a0d2d6.png 1020w,\n/static/73e1f16d1334bd57f1a8ece74d6d0c21/9d8cf/48a0d2d6.png 1216w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>우측의 <code class=\"language-text\">DNS 관리툴</code> 탭으로 들어간다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/a4cb9491393cae21332985fd64fb8c0d/a47a4/dbaa42b0.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 26.47058823529412%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA0UlEQVR42mWQC47DIAxEuf9Bq7ShBAiG8J0OtFLVXaQn28B4DOqmPbbdwOkHRsloKaJmxoF/9D8MYlOHIYmaeBUo4zzsmSBnwH7fcOgdSYSH88L1IS8kXQjxy6wfLmGzEYY9tAtQwq5GCmiG226xHRFHbHiGsjBSFzO/al9jjT7p6L0xNrRa2FyQaK5EIhynnMunAu0jnj7hfghMyHR91zOfT6qtUpg5YUSuzHNZzw0S4IyF6nRqra2G07XSbYzPJIxl/iuF3GD9Zep+6toQT8ELsPqF7ZFV6ZYAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='dbaa42b0' title='' src='/static/a4cb9491393cae21332985fd64fb8c0d/ca1dc/dbaa42b0.png' srcset='/static/a4cb9491393cae21332985fd64fb8c0d/e7570/dbaa42b0.png 170w,\n/static/a4cb9491393cae21332985fd64fb8c0d/f46e7/dbaa42b0.png 340w,\n/static/a4cb9491393cae21332985fd64fb8c0d/ca1dc/dbaa42b0.png 680w,\n/static/a4cb9491393cae21332985fd64fb8c0d/02d09/dbaa42b0.png 1020w,\n/static/a4cb9491393cae21332985fd64fb8c0d/9d567/dbaa42b0.png 1360w,\n/static/a4cb9491393cae21332985fd64fb8c0d/a47a4/dbaa42b0.png 1421w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>도메인의 <code class=\"language-text\">설정</code> 탭으로 들어간다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/edf6fd8e323628c5351511474c4ae487/047c3/0b4d4be0.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 20.58823529411765%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAiElEQVR42qXM2wqDMBCEYd//KduCBmM0J03JJvVvFHrRglcd+GAWhu360aCmBbcmbEy4K+s13yi7oW2kU8OAc44z+86/6YwxaK15psRsJrz3p+O2zjOHSGxqrV9Ks78qYxQey9a2lnVLdCEE5kmjbj3q3lNyJotQmnz0LEjrvw8/pJSmnhuRwhstujbY9gqqNQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='0b4d4be0' title='' src='/static/edf6fd8e323628c5351511474c4ae487/ca1dc/0b4d4be0.png' srcset='/static/edf6fd8e323628c5351511474c4ae487/e7570/0b4d4be0.png 170w,\n/static/edf6fd8e323628c5351511474c4ae487/f46e7/0b4d4be0.png 340w,\n/static/edf6fd8e323628c5351511474c4ae487/ca1dc/0b4d4be0.png 680w,\n/static/edf6fd8e323628c5351511474c4ae487/02d09/0b4d4be0.png 1020w,\n/static/edf6fd8e323628c5351511474c4ae487/047c3/0b4d4be0.png 1208w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>DNS 관리 탭의 <code class=\"language-text\">설정</code> 혹은 <code class=\"language-text\">레코드 수정</code>에 들어간다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/be57907274a476d1261092d3bac97cd0/51f47/d830ba27.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 38.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABOUlEQVR42pWRS07DMBCGc6giIa7AissU0U2PQViU1xKJAyEhWKaQOHYedvyKf2bSpCo7GOmXXzPf/Lazq9cKly8lzp/2WD3scfb4f61IXH/x/IWs1g4sxTJ+kuiGo5a9RfI0/6RGGYfeRWTDMEBajzGNMFoj0ciRUoK1dl4njOMI7z2cs+j7HjHQnM75jMdAa47MOgcf45QUQgA32O3ucZvnyPM7SCmnRN4fqJDBrKZtocmApxohFVTbEZqAkWCY3XAYY7DdbnG9XmOzuUFZlkego+bsnKNpmgkYQkRNwLbrDg4rUcPSVbg7w1lFUUAIgY6S2DVDGGhnh7xWSkHTrZwPqGoF2XTsC9nbt8F7ZaHdweniYIk077EW2DIHvW+lAz6Ew2dNn+JHekPiDIESfnP+HIG4zGAx4wc1NFLtdAuILQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='d830ba27' title='' src='/static/be57907274a476d1261092d3bac97cd0/ca1dc/d830ba27.png' srcset='/static/be57907274a476d1261092d3bac97cd0/e7570/d830ba27.png 170w,\n/static/be57907274a476d1261092d3bac97cd0/f46e7/d830ba27.png 340w,\n/static/be57907274a476d1261092d3bac97cd0/ca1dc/d830ba27.png 680w,\n/static/be57907274a476d1261092d3bac97cd0/51f47/d830ba27.png 892w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>위와 같이 레코드를 추가하고 저장한다.</p>\n<blockquote>\n<p>CNAME 설정은 향후 서브도메인 설정을 위한 설정입니다.</p>\n</blockquote>\n<p>이제 <a href=\"http://pium.life\">http://pium.life</a> 로 접속하면 서버로 바로 접속할 수 있게된다. (SSH 접속이 아닌 HTTP 접속을 의미한다.)</p>\n<h2>환경 살펴보기</h2>\n<p>피움은 하나의 EC2에 프론트엔드, 백엔드의 배포를 모두 진행하려고한다.</p>\n<p>이를 위해서라면 서로 다른 포트에 서비스를 띄워둔 뒤 각 요청별로 포트를 분산시킬 필요가 있다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 555px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/6b66749ad542471689f2ca5ecb3a11d0/98c96/ee357fa5.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 51.17647058823529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTklEQVR42qWRu04CQRSGeQPfxdfwJSxsLH0DE2sTGiobCzoLY0OIhUYTotHEoEEwS1y5CCQs4F5wN7s7M5/DirIYCEbP5GRmTvGd/z8nwx9D6bMoMv+B3VslLl6PCWXwXV8OVGo+pzWlZPJs2lWy5R3O2kdYfmc1UKVyEjL09Ud+/qtVWuUCJ+1Dbnqn80AhBKPRCM/zcF0X23EY22/Q76JqZfADrPM8jc01KO6hHA/xYiSAh8EVpW6BWEYzoNI2TNOkXq9jGEZy9/sWjUaX68tbLFfQym7ztK7N7G+gdSLiaOmCEsu+7yfqJionGcYCO9Zz8mIcPTK3fkczt4V8LNJ5h0rXQWrGcySphZJAzcaUWbyPWUclJUNts+8GDNyJPkml51HqjTkYw+4QjGgF8Odi5sxNC0OhyHuQs8GMfwlMK/7KdLOhHsdAQJSy/AFt8QHX+h2MDwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='ee357fa5' title='' src='/static/6b66749ad542471689f2ca5ecb3a11d0/98c96/ee357fa5.png' srcset='/static/6b66749ad542471689f2ca5ecb3a11d0/e7570/ee357fa5.png 170w,\n/static/6b66749ad542471689f2ca5ecb3a11d0/f46e7/ee357fa5.png 340w,\n/static/6b66749ad542471689f2ca5ecb3a11d0/98c96/ee357fa5.png 555w' sizes='(max-width: 555px) 100vw, 555px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>때문에 위와 같은 흐름으로 요청이 진행되는 것이 최종 목표다!</p>\n<h3>EC2 보안규칙</h3>\n<p>우아한테크코스 과정에서 제공되는 EC2의 보안규칙은 다음과 같다.</p>\n<ul>\n<li>사내에서만 22번 포트 접속 가능</li>\n<li>80, 443은 열려있음</li>\n<li>이외의 포트는 열려있지 않음.</li>\n</ul>\n<p>우리가 흔히 개발을 하면서 사용하는 3000번 포트 혹은 8080번 포트를 통해 해당 서버에 접근하지 못한다는 이야기다.</p>\n<p>즉, 다시말해 pium.life:8080과 같은 접근이 안된다는 이야기다.</p>\n<p>인바운드 규칙에서 8080 혹은 3000번 포트를 열어버리는 방법도 있겠지만 보안 규칙에 손대지 않으면서 해결할 수 있는 방법을 찾아보자.</p>\n<h2>nginx로 포트포워딩하기</h2>\n<p>linux에 존재하는 <code class=\"language-text\">iptables</code> 명령어를 통해 서버 자체적으로 포트포워딩 환경을 구성할 수도 있지만 현재 피움은 하나의 서버에서 두개의 어플리케이션을 배포하고 있고, 도메인도 하나다.</p>\n<p>따라서 후에 설명할 서브도메인을 적용하기 위해서라도 nginx를 이용하기로 한다.</p>\n<h3>nginx 설치하기</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> nginx</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">systemctl status nginx</code></pre></div>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/62f73813a3dbce8bfdc5b39ca49641f1/1ed31/28e0139a.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 18.823529411764707%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAApUlEQVR42pWPOw+DMBCDI4TCkPJGKC8ULjQ0Qv3/f8/VZWBplw6f7FtsnziOA9ppGG/gyYMiIVIEEcE5h23bbu+9h1IKbduirmsIIb4504nwCqA3QScN6y1CCIV1XWGtxb7vMMYgxliCl2XBNE2FcRwxz3PxUkqInDPSM+HKFyhQaR+GoWjf90W7rrs9wyF8s3I4Ky+uqgqC23mNeig0jfz9xh98AJx/X27IEAMSAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='28e0139a' title='' src='/static/62f73813a3dbce8bfdc5b39ca49641f1/ca1dc/28e0139a.png' srcset='/static/62f73813a3dbce8bfdc5b39ca49641f1/e7570/28e0139a.png 170w,\n/static/62f73813a3dbce8bfdc5b39ca49641f1/f46e7/28e0139a.png 340w,\n/static/62f73813a3dbce8bfdc5b39ca49641f1/ca1dc/28e0139a.png 680w,\n/static/62f73813a3dbce8bfdc5b39ca49641f1/1ed31/28e0139a.png 974w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>이제 주소창에 인스턴스 ip 를 치고 접속하면 다음과 같이 nginx default 페이지를 볼 수 있다. </p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 663px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/9a3c9696e83150d8f8c8cc0df8288ade/5c8e6/9345764b.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 38.23529411764706%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABcklEQVR42l1STW+CUBD0//8B7x7kZIwnEz1oqPKhNeIFNBaBIqgINSrBpgrTt9tirS+Z7OyGN292l0qn08F0OoVlWYzFYoHlcon5fA7P82CaJgzD4HqSJKBzu92Q5zmDeJkXRYFKrVZDvS6h1Wqh0Wig2Wyi1+uh3W5zrFarkCQJ3W4XcRyzIF18PlRjwcvlgizLcDqdcD6f/8U0TXE8HjkSDocD9vs9NpsNdrud4AnW64A5fceCw+EQmq5h8joB8cFgAEVRIMsyVFWFMZuJuiK4Ji5G2G638H0fQeALHsBxbB5NOY4KvRaGAaIoYtBrjuuKWshuqBaGnnD1Lpx/sMs0pQ4K4Qqiu6eWaSGapmE0GkHXdXY3Ho85J5eKooq4Qr/vQn6xhSOXndl2BtP6wsr5xPV6E2K/S3FcR8xhzXOhVgjUFtWSJOZ5xnEuUAh3xcNCijtKdz+CjsMzCIKA26Tctt9Y8O/kd5S/S54XdzwKfgPTY01z0d7cygAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='9345764b' title='' src='/static/9a3c9696e83150d8f8c8cc0df8288ade/5c8e6/9345764b.png' srcset='/static/9a3c9696e83150d8f8c8cc0df8288ade/e7570/9345764b.png 170w,\n/static/9a3c9696e83150d8f8c8cc0df8288ade/f46e7/9345764b.png 340w,\n/static/9a3c9696e83150d8f8c8cc0df8288ade/5c8e6/9345764b.png 663w' sizes='(max-width: 663px) 100vw, 663px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<h3>80 포트 접속을 8080 포트로</h3>\n<blockquote>\n<p>해당 과정은 8080포트에 애플리케이션이 구동중인 상태에서 진행됩니다.\n다음 명령어로 8080포트에서 애플리케이션이 구동중인지 확인한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">lsof</span> <span class=\"token parameter variable\">-i</span> tcp:8080</code></pre></div>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 598px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/51a5f82dfc1fcb417df2c1222b0262f7/02e46/1573063d.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 9.411764705882353%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAdklEQVR42j2Nuw7DIBRDYUJqRG4hAak8rkgEKwNz//+33MDQ4cjy4GPB34ytvkCGoJSCMQZEb8SYcN8Xcs7ovWOMgRACrLXw3i+ICEIISCn/CP4w9m1HrfWRxJVTfJ4HUkpgZrTW1njKZp8nk1LKEmutV3fO4Qe5aTJ2IHR74gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='1573063d' title='' src='/static/51a5f82dfc1fcb417df2c1222b0262f7/02e46/1573063d.png' srcset='/static/51a5f82dfc1fcb417df2c1222b0262f7/e7570/1573063d.png 170w,\n/static/51a5f82dfc1fcb417df2c1222b0262f7/f46e7/1573063d.png 340w,\n/static/51a5f82dfc1fcb417df2c1222b0262f7/02e46/1573063d.png 598w' sizes='(max-width: 598px) 100vw, 598px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n</blockquote>\n<p>이제 nginx 설정파일을 작성하여 80포트로 오는 요청을 8080포트로 전환시켜본다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token builtin class-name\">cd</span> /etc/nginx/sites-available/\n\n<span class=\"token function\">sudo</span> <span class=\"token function\">vi</span> default</code></pre></div>\n<blockquote>\n<p>주석처리 되어있는 부분은 제외하고 코드로 표현합니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 변경 전 파일내용</span>\nserver <span class=\"token punctuation\">{</span>\n        listen <span class=\"token number\">80</span> default_server<span class=\"token punctuation\">;</span>\n        listen <span class=\"token punctuation\">[</span>::<span class=\"token punctuation\">]</span>:80 default_server<span class=\"token punctuation\">;</span>\n\n        root /var/www/html<span class=\"token punctuation\">;</span>\n\n        index index.html index.htm index.nginx-debian.html<span class=\"token punctuation\">;</span>\n\n        server_name _<span class=\"token punctuation\">;</span>\n\n        location / <span class=\"token punctuation\">{</span>\n                try_files <span class=\"token variable\">$uri</span> <span class=\"token variable\">$uri</span>/ <span class=\"token operator\">=</span><span class=\"token number\">404</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>처음 파일을 열어보면 위와같이 설정되어있을 것이다.</p>\n<p>최대한 간략하게 포트를 변경한다는 목적만 달성해보기 위해 다음 내용들을 수정해보자.</p>\n<ul>\n<li><code class=\"language-text\">root /var/www/html;</code> 주석처리</li>\n<li><code class=\"language-text\">index index.html index.htm index.nginx-debian.html;</code> 주석처리</li>\n<li>\n<p><code class=\"language-text\">location / { ... }</code> 내부 내용에 다음 내용 추가</p>\n<ul>\n<li><code class=\"language-text\">proxy_set_header Host $host:$server_port;</code></li>\n<li><code class=\"language-text\">proxy_set_header X-Real-IP $remote_addr;</code></li>\n<li><code class=\"language-text\">proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</code></li>\n<li><code class=\"language-text\">proxy_pass http://127.0.0.1:8080;</code></li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 변경된 파일내용</span>\nserver <span class=\"token punctuation\">{</span>\n        listen <span class=\"token number\">80</span> default_server<span class=\"token punctuation\">;</span>\n        listen <span class=\"token punctuation\">[</span>::<span class=\"token punctuation\">]</span>:80 default_server<span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\"># root /var/www/html;</span>\n\n        <span class=\"token comment\"># index index.html index.htm index.nginx-debian.html;</span>\n\n        server_name _<span class=\"token punctuation\">;</span>\n\n        location / <span class=\"token punctuation\">{</span>\n                proxy_set_header Host <span class=\"token variable\">$host</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">$server_port</span><span class=\"token punctuation\">;</span>\n                proxy_set_header X-Real-IP <span class=\"token variable\">$remote_addr</span><span class=\"token punctuation\">;</span>\n                proxy_set_header X-Forwarded-For <span class=\"token variable\">$proxy_add_x_forwarded_for</span><span class=\"token punctuation\">;</span>\n                proxy_pass http://127.0.0.1:8080<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위와같이 설정파일을 수정했다면 다음 명령어를 수행해 nginx를 다시 시작한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> systemctl restart nginx</code></pre></div>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 604px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/eef9247c8964e484681e7dfae0a0e86b/1994c/232c6d5d.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 28.235294117647058%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1ElEQVR42o1QyaqEQBDr//8jBfEg6FkvgrjhLi4XD+5mSEGD8B7DFISUVZikWpmmCcuyYNs2HMeB53mCIAjg+z4Mw4DruljXFaz7vvE8z79gqaqqkGUZkiRBmqZo2xZN06AsSyzLgiiKRJxCv5Tquk5EpmkSzPOMuq4xjqOIcs953/fS04x9nueyH4ZBmIF4heLPTFkUhQjpdFwex4Ft24TP8xSw3/dd5uT3N69QcRzLyeQwDOVEgqlpRKYRmQk5o6l+sz8nX9cFDSagi+7fyd749p4fy07GAzZ6YT4AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='232c6d5d' title='' src='/static/eef9247c8964e484681e7dfae0a0e86b/1994c/232c6d5d.png' srcset='/static/eef9247c8964e484681e7dfae0a0e86b/e7570/232c6d5d.png 170w,\n/static/eef9247c8964e484681e7dfae0a0e86b/f46e7/232c6d5d.png 340w,\n/static/eef9247c8964e484681e7dfae0a0e86b/1994c/232c6d5d.png 604w' sizes='(max-width: 604px) 100vw, 604px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>스프링부트 애플리케이션을 실행중이였다면 위와같은 Whitelabel Error Page를 확인할 수 있을것이다.</p>\n<h2>서브도메인 구성하기</h2>\n<p>이제 80포트에서 8080포트로 요청을 변환하는 과정은 성공했다.</p>\n<p>하나의 서버에 프론트엔드, 백엔드 코드가 같이 띄워져야하므로 서브도메인을 통해 페이지와 API를 구분해줘야한다.</p>\n<h3>index 파일 지정하기 - default 파일 수정</h3>\n<p>프론트에서 빌드 산출물로 나온 index.html을 기본 페이지로 참고하도록 설정하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token builtin class-name\">cd</span> /etc/nginx/sites-available/\n\n<span class=\"token function\">sudo</span> <span class=\"token function\">vi</span> default</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 변경 전 설정내용</span>\nserver <span class=\"token punctuation\">{</span>\n        listen <span class=\"token number\">80</span> default_server<span class=\"token punctuation\">;</span>\n        listen <span class=\"token punctuation\">[</span>::<span class=\"token punctuation\">]</span>:80 default_server<span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\"># root /var/www/html;</span>\n\n        <span class=\"token comment\"># index index.html index.htm index.nginx-debian.html;</span>\n\n        server_name _<span class=\"token punctuation\">;</span>\n\n        location / <span class=\"token punctuation\">{</span>\n                proxy_set_header Host <span class=\"token variable\">$host</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">$server_port</span><span class=\"token punctuation\">;</span>\n                proxy_set_header X-Real-IP <span class=\"token variable\">$remote_addr</span><span class=\"token punctuation\">;</span>\n                proxy_set_header X-Forwarded-For <span class=\"token variable\">$proxy_add_x_forwarded_for</span><span class=\"token punctuation\">;</span>\n                proxy_pass http://127.0.0.1:8080<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>기존에 80포트를 8080포트로 포워딩시켜주는 설정을 바꿔준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 변경 후 설정내용</span>\nserver <span class=\"token punctuation\">{</span>\n        listen <span class=\"token number\">80</span> default_server<span class=\"token punctuation\">;</span>\n        listen <span class=\"token punctuation\">[</span>::<span class=\"token punctuation\">]</span>:80 default_server<span class=\"token punctuation\">;</span>\n\n        root /var/www/html<span class=\"token punctuation\">;</span>\n\n        index index.html<span class=\"token punctuation\">;</span>\n\n        server_name pium.life<span class=\"token punctuation\">;</span>\n\n        location / <span class=\"token punctuation\">{</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이제 pium.life로 접속하면 <code class=\"language-text\">/var/www/html</code> 경로에 있는 <code class=\"language-text\">index.html</code>을 참조하도록 설정되었다.</p>\n<p>위 설정에 따르면 <code class=\"language-text\">index.html</code> 및 <code class=\"language-text\">bundle.js</code>, <code class=\"language-text\">assets</code> 등의 프론트 리소스들은 서버의 <code class=\"language-text\">/var/www/html</code>를 기준으로 위치시키면 된다.</p>\n<blockquote>\n<p>빌드 산출물 및 CD와 관련된 내용은 본 게시글에서 다루지 않습니다.</p>\n</blockquote>\n<h3>API 서버 지정하기 - api_config 파일 만들기</h3>\n<p><a href=\"http://api.pium.life\">http://api.pium.life</a> 로 API를 호출하도록 구성해보자.</p>\n<p>nginx는 기본적으로 <code class=\"language-text\">/etc/nginx/sites-enabled</code> 경로에 있는 파일들을 참고하여 설정파일에 적용한다.</p>\n<blockquote>\n<p><code class=\"language-text\">/etc/nginx/nginx.conf</code> 파일의 60번째 줄 참고</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 547px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/03d7a15ebc7bea96de5efdc6e60d72a2/25257/f4ceb33e.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 73.52941176470587%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABh0lEQVR42p1U23KCMBBNsglJ0HKJ7QgDHWqnxcE+yLf0//9lu0lUsKOO+nDmLJDsnr3BcsNQCoaMEXSCrMiRZTnassR6vca2bbHrOmyaBquqQudcsKWU8c5/lHZyKESKgltkXCDnkuCZn+DPzO2LmCsUsESpKuKSFKwI6+D46uVLWKWTQy4MAmjM4HiAP+bMo5ilzFKL1hX42zhkQjzndF5DzhWCLCnlLKQvxPJxh68LhgqmphizQ236CP2FSbKh94v71eakEE4KDSb6g5y8E2+oQTUqglRvz6UcFQ5BmVeY6I7wSQE6KoWj7zYE9RyRzmACnzXFjwhATvV7iRwOejsLaQMUh29lsP2ZyEfbxRpOc7gIDfHNiRH1gUnZvc2ZKwTqqo8Suiy8wiwAYBWCTBdvOHdng03rJoFmkDpPu6qUpG0BYqA6JuQYwg57vmtsGK0h6yhAK3H7vcX9fsTd7geHYcC+7wPGccS6rm/vcmp1fPBKFSkleEXWWuq4DrZnY8zp3bUfxB9XPjy8n5tihwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='f4ceb33e' title='' src='/static/03d7a15ebc7bea96de5efdc6e60d72a2/25257/f4ceb33e.png' srcset='/static/03d7a15ebc7bea96de5efdc6e60d72a2/e7570/f4ceb33e.png 170w,\n/static/03d7a15ebc7bea96de5efdc6e60d72a2/f46e7/f4ceb33e.png 340w,\n/static/03d7a15ebc7bea96de5efdc6e60d72a2/25257/f4ceb33e.png 547w' sizes='(max-width: 547px) 100vw, 547px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n</blockquote>\n<p>다음 과정을 통해 서브도메인 설정을 해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token builtin class-name\">cd</span> /etc/nginx/sites-available\n\n<span class=\"token function\">sudo</span> <span class=\"token function\">vi</span> api_config</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># api_config 파일 내용</span>\nserver <span class=\"token punctuation\">{</span>\n        listen <span class=\"token number\">80</span><span class=\"token punctuation\">;</span>\n        listen <span class=\"token punctuation\">[</span>::<span class=\"token punctuation\">]</span>:80<span class=\"token punctuation\">;</span>\n\n        server_name api.pium.life<span class=\"token punctuation\">;</span>\n        \n        location / <span class=\"token punctuation\">{</span>\n                proxy_set_header Host <span class=\"token variable\">$host</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">$server_port</span><span class=\"token punctuation\">;</span>\n                proxy_set_header X-Real-IP <span class=\"token variable\">$remote_addr</span><span class=\"token punctuation\">;</span>\n                proxy_set_header X-Forwarded-For <span class=\"token variable\">$proxy_add_x_forwarded_for</span><span class=\"token punctuation\">;</span>\n\n                proxy_pass http://127.0.0.1:8080<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">server_name</code> 옵션을 통해 api.pium.life 라는 도메인으로 접근하는 요청을 확인하고, 맞다면 8080 포트로 변경한다.</p>\n<p>위와 같이 파일을 작성했으면 <code class=\"language-text\">sites-enabled</code> 경로에 soft link(바로가기)를 생성한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">ln</span> <span class=\"token parameter variable\">-s</span> /etc/nginx/sites-available/api_config /etc/nginx/sites-enabled/api_config</code></pre></div>\n<p>이제 nginx를 재시작하여 설정을 적용해보자.</p>\n<blockquote>\n<p>💡 Tip : <code class=\"language-text\">nginx -t</code> 명령어를 통해 현재 설정파일이 정상적으로 작성되었는지 확인할 수있다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 545px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/b33f0caf9870e4f0864cfa6f8ea7af4d/f2ede/10d7627b.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 10.588235294117647%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAbklEQVR42k2NyQpDIRRDLS3igC3uBHFWHP7//1K8q7cICYcDYVJKPGOMgVIKIQTUWtF7p91ag3MO1loIIaC1Ju825xwf/gZ7MbA5J8nee+y9cc6hzjkTizFirUX8ZoxB/j1KKaGUgtEH6ij4/gz+iCQzrFRZETQAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='10d7627b' title='' src='/static/b33f0caf9870e4f0864cfa6f8ea7af4d/f2ede/10d7627b.png' srcset='/static/b33f0caf9870e4f0864cfa6f8ea7af4d/e7570/10d7627b.png 170w,\n/static/b33f0caf9870e4f0864cfa6f8ea7af4d/f46e7/10d7627b.png 340w,\n/static/b33f0caf9870e4f0864cfa6f8ea7af4d/f2ede/10d7627b.png 545w' sizes='(max-width: 545px) 100vw, 545px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n</blockquote>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/0b93d643e5673d6286e16237ce61a080/833a5/04601361.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 31.176470588235293%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA+klEQVR42oWQ2WqDUBCGfbOmtJe1TUublIQG+prVK3spiLl0ARVB3BdwV/zrHDA0UujAzyxn5uPMcLv9Ebv9AYfjCfzjM/inFzzw2zne4vXtHR+nT1a/2dxhc3v/rzhJkiAIAiTpG6IoQpZlqKoK9XyGoij4mt/yogDZNE34y6i+iEvTFJ7nXRRFEYIgQBiG8H0fpmmimIFN06Cua5RlyUQ5+aqqruAcAVzXZTCCEIziPM8RxzEbIuAiqlFflmXM0/wV0LZtGIYBx3Gg6zo0TYNlWUiS5CIapk0IsP7R2rhxHDEMA1PXdej7nolWatuW1cgvOfX9vtn6rj+fgqGzBfn+VAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='04601361' title='' src='/static/0b93d643e5673d6286e16237ce61a080/ca1dc/04601361.png' srcset='/static/0b93d643e5673d6286e16237ce61a080/e7570/04601361.png 170w,\n/static/0b93d643e5673d6286e16237ce61a080/f46e7/04601361.png 340w,\n/static/0b93d643e5673d6286e16237ce61a080/ca1dc/04601361.png 680w,\n/static/0b93d643e5673d6286e16237ce61a080/833a5/04601361.png 681w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p><a href=\"http://api.pium.life\">http://api.pium.life</a> 로 접속하면 API로 연결되는것을 확인할 수 있다.</p>\n<h2>정리</h2>\n<ul>\n<li>8080 포트에 API 애플리케이션을 실행한다.</li>\n<li>도메인 구입 및 A 레코드, CNAME을 설정한다.</li>\n<li>nginx를 설치한다.</li>\n<li>프론트 빌드 산출물을 <code class=\"language-text\">/var/www/html</code> 경로에 준비한다. (index.html, bundle.js, assets 등)</li>\n<li>서브도메인 및 포트포워딩 설정한다.</li>\n</ul>\n<h3>nginx 설정 명령어 따라가기</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># nginx 설치</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> nginx\n\n<span class=\"token comment\"># default 파일 수정</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">vi</span> /etc/nginx/sites-available/default</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># /etc/nginx/sites-available/default 파일 내용</span>\nserver <span class=\"token punctuation\">{</span>\n        listen <span class=\"token number\">80</span> default_server<span class=\"token punctuation\">;</span>\n        listen <span class=\"token punctuation\">[</span>::<span class=\"token punctuation\">]</span>:80 default_server<span class=\"token punctuation\">;</span>\n\n        root /var/www/html<span class=\"token punctuation\">;</span>\n\n        index index.html<span class=\"token punctuation\">;</span>\n\n        server_name pium.life<span class=\"token punctuation\">;</span>\n\n        location / <span class=\"token punctuation\">{</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># api_config 파일 작성</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">vi</span> /etc/nginx/sites-available/api_config</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># api_config 파일 내용</span>\nserver <span class=\"token punctuation\">{</span>\n        listen <span class=\"token number\">80</span> default_server<span class=\"token punctuation\">;</span>\n        listen <span class=\"token punctuation\">[</span>::<span class=\"token punctuation\">]</span>:80 default_server<span class=\"token punctuation\">;</span>\n\n        root /var/www/html<span class=\"token punctuation\">;</span>\n\n        index index.html<span class=\"token punctuation\">;</span>\n\n        server_name pium.life<span class=\"token punctuation\">;</span>\n\n        location / <span class=\"token punctuation\">{</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># nginx 재시작 및 설정적용</span>\n<span class=\"token function\">sudo</span> systemctl restart nginx</code></pre></div>\n<h2>Reference</h2>\n<ul>\n<li><a href=\"https://jminie.tistory.com/110\">https://jminie.tistory.com/110</a></li>\n<li><a href=\"https://customer.gabia.com/manual/domain/287/1201\">https://customer.gabia.com/manual/domain/287/1201</a></li>\n</ul>","frontmatter":{"title":"피움의 배포과정","date":"July 18, 2023","update":"July 18, 2023","tags":["배포","인프라"],"series":null},"fields":{"slug":"/pium-deploy-step/","readingTime":{"minutes":10.38}}},"seriesList":{"edges":[{"node":{"id":"28f1d87e-d3fc-5567-8531-57649652864f","fields":{"slug":"/sprint-idea/"},"frontmatter":{"title":"구글 스프린트 기반 아이디어 도출"}}},{"node":{"id":"4a9246fb-171b-5973-88fc-864034e78afd","fields":{"slug":"/blog-starter/"},"frontmatter":{"title":"피움 블로그 생성과정"}}},{"node":{"id":"c826ce0e-1ea7-517c-8d19-84e90a59a798","fields":{"slug":"/jenkins-setting/"},"frontmatter":{"title":"젠킨스 설치하기"}}},{"node":{"id":"a387bf4f-567f-50e7-b6a7-99a1a1c8971b","fields":{"slug":"/jpa-notnull-nullable/"},"frontmatter":{"title":"@NotNull과 nullable = false는 어떤 차이가 있을까?"}}},{"node":{"id":"a78e224b-b711-5071-8e90-013d6f4bebc3","fields":{"slug":"/pium-deploy-step/"},"frontmatter":{"title":"피움의 배포과정"}}},{"node":{"id":"ce07fbab-1ed5-5f1e-8e2f-eb430879b56a","fields":{"slug":"/fe-tanstack-query/"},"frontmatter":{"title":"프론트엔드: Tanstack Query 사용에 대하여"}}},{"node":{"id":"159c943b-1a50-57dd-aa71-7557364752a5","fields":{"slug":"/ci-cd-setting/"},"frontmatter":{"title":"Jenkins와 Github Webhook을 이용해 CI/CD 구축하기"}}},{"node":{"id":"dea45a4a-bfde-5fbb-8a97-42d3a3e77a0b","fields":{"slug":"/jenkins-hook-by-label/"},"frontmatter":{"title":"PR 라벨로 젠킨스 빌드유발을 구분하기"}}},{"node":{"id":"1a03734e-d413-553f-9152-1dad2fc4acca","fields":{"slug":"/apply-https/"},"frontmatter":{"title":"내 서버에 HTTPS 설정하기"}}},{"node":{"id":"cecbc8b9-db00-562b-aa0b-06c406cfc44a","fields":{"slug":"/bundle-analyze/"},"frontmatter":{"title":"bundle-analyze를 통한 bundle 크기 분석"}}},{"node":{"id":"707f8ffb-1409-5c27-b15a-5661b235c226","fields":{"slug":"/db-drop-stop/"},"frontmatter":{"title":"Table Drop 못하게 막아버리기"}}},{"node":{"id":"fe4b591a-4dd5-5dd2-b18a-b318afd1e9e3","fields":{"slug":"/transactional-not-in-restassured/"},"frontmatter":{"title":"[트러블슈팅] @SpringbootTest의 RANDOM_PORT 환경에서 @Transactional 어노테이션을 사용했을 때, RestAssured GET 요청이 수행되지 않는 경우(트랜잭션 격리 이해하기)"}}},{"node":{"id":"80aa708e-ef8a-5c79-9644-cb8c04d55a63","fields":{"slug":"/acceptance-test-resolve/"},"frontmatter":{"title":"인수테스트 데이터 초기화하기"}}},{"node":{"id":"15def1d5-c20f-5d07-b46e-24a14661365f","fields":{"slug":"/react-setting-without-cra/"},"frontmatter":{"title":"webpack으로만 React 설정하기 (without CRA)"}}},{"node":{"id":"66383c86-e2c8-533a-90e0-2effae572742","fields":{"slug":"/stylelint-and-husky/"},"frontmatter":{"title":"stylelint와 husky를 통해 컨벤션 통일하기"}}},{"node":{"id":"ed5951d5-beda-5a8f-adb2-07c2fcb38d5e","fields":{"slug":"/OAuth2.0/"},"frontmatter":{"title":"내가 이해한 OAuth2.0"}}},{"node":{"id":"45eeb9a3-557d-5704-8fd9-925283e1e27b","fields":{"slug":"/restdocs-start/"},"frontmatter":{"title":"RestDocs로 API 문서화하기"}}},{"node":{"id":"663b560a-734d-51a9-a6dc-3c4f50716c74","fields":{"slug":"/spring-event-apply/"},"frontmatter":{"title":"Spring Event 적용하기"}}},{"node":{"id":"55ae8038-3f65-5a59-8db3-c7405e7fc125","fields":{"slug":"/github-actions-cypress/"},"frontmatter":{"title":"피움 Cypress 자동화 구축기"}}},{"node":{"id":"503e9e71-eda3-53d7-8142-7c309faf213e","fields":{"slug":"/why_we_applied_querydsl/"},"frontmatter":{"title":"피움 서비스의 Querydsl 도입 이유"}}},{"node":{"id":"709124d0-5b05-5530-804d-e90ec9856a13","fields":{"slug":"/querydsl_apply_procedure/"},"frontmatter":{"title":"피움 서비스의 Querydsl 적용 과정"}}},{"node":{"id":"5c865dcb-cefd-58be-8968-b5edf6c8080c","fields":{"slug":"/server-logging/"},"frontmatter":{"title":"Logback을 이용해 운영 환경 별 로그 남기기"}}},{"node":{"id":"8269f166-d041-533c-9d44-332d8d8c3dca","fields":{"slug":"/server-monitoring/"},"frontmatter":{"title":"CloudWatch를 이용한 모니터링 환경 구성"}}},{"node":{"id":"0faec7ad-3bd1-5f5e-9222-115f771df8ed","fields":{"slug":"/tanstack-query-cache-trouble-shooting/"},"frontmatter":{"title":"InfinityQuery에서 fetch가 제대로 이루어지지 않는다?!?!"}}},{"node":{"id":"c77f7199-7fc6-53a3-a1fb-0792e05655a7","fields":{"slug":"/OAuth2.0-backend/"},"frontmatter":{"title":"OAuth 2.0 로그인 구현하기 (카카오)"}}},{"node":{"id":"12e4480d-386b-5d0e-bd69-4209fed36066","fields":{"slug":"/OAuth-test-backend/"},"frontmatter":{"title":"외부 API 를 의존하는 OAuth 로그인 테스트하기"}}},{"node":{"id":"ff40e109-cc92-5d83-a213-ca9d07136d95","fields":{"slug":"/aws-s3-apply/"},"frontmatter":{"title":"AWS S3로 정적 이미지 배포하기"}}}]},"previous":{"fields":{"slug":"/jpa-notnull-nullable/"},"frontmatter":{"title":"@NotNull과 nullable = false는 어떤 차이가 있을까?"}},"next":{"fields":{"slug":"/fe-tanstack-query/"},"frontmatter":{"title":"프론트엔드: Tanstack Query 사용에 대하여"}}},"pageContext":{"id":"a78e224b-b711-5071-8e90-013d6f4bebc3","series":null,"previousPostId":"a387bf4f-567f-50e7-b6a7-99a1a1c8971b","nextPostId":"ce07fbab-1ed5-5f1e-8e2f-eb430879b56a"}},"staticQueryHashes":[],"slicesMap":{}}