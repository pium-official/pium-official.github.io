{"componentChunkName":"component---src-templates-post-jsx","path":"/pium-deploy-step/","result":{"data":{"site":{"siteMetadata":{"title":"pium.log"}},"markdownRemark":{"id":"a78e224b-b711-5071-8e90-013d6f4bebc3","excerpt":"이 글은 우테코 피움팀 크루 '주노'가 작성했습니다. 서론  http://pium.life 로 접속하면 피움의 홈페이지가 나오기까지의 과정을 기록으로 남겨보려고 한다. 본 과정은 서버 구축을 처음 하면서 과정을 이해하기위해 작성된 글입니다. 빠르게 따라할 수 있는 설정 기반 글을 원한다면 마지막 목차인 정리를 확인해보시길 바랍니다. 본 과정에서는 소량의 …","html":"<blockquote>\n<p>이 글은 우테코 피움팀 크루 '<a href=\"https://github.com/Choi-JJunho\">주노</a>'가 작성했습니다.</p>\n</blockquote>\n<h2>서론</h2>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/f67e51b2131d2821f9e1581e6399b0fd/cc6c5/3162b98e.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 63.52941176470588%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaklEQVR42q2RXUsCQRSGZzHavIjt+6Kb/kmRP8VrRf+BLBqs7haFX3Rld0U/Z69VXOqq8Bs/cM7MGzNqaJiYdOBhmDPnfeccDrNMM3JwtO+cnJ2nLOvYtg5PbcMwbMbYGgyNYYRsI2TaO7t7qXDYckzTvGbpdMarVJ6Qz5eoWCyjUCzD8+6WcL1bzfzuZF04Thb3DwUUS48ol8r08vyKTObGZUEQuJjGGADfEqVFEARZVq/XPXUhIhJCQEELTDjH2+AD76NPTIjrnJByyqyec07Ko1qtuqzRaGhDKSVhRWiBIAhI/BZCCK2t1WqrDZVYSNUhodvrod3toN3poNfv6Zx6W/xgraGUEl0+xEhMNEMaY8DH+lTM8/3JUNdu1CGp7ubgBwtvG4/811gynG95tn41g/p7I77rheAzw9z/d+j7fo5zjmazSa1WC9ugtEQE3/cdFo1GL2KxWCSRSFzG4/GrbVDaZDIZUV5fpR9jAbF8EjQAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='3162b98e' title='' src='/static/f67e51b2131d2821f9e1581e6399b0fd/ca1dc/3162b98e.png' srcset='/static/f67e51b2131d2821f9e1581e6399b0fd/e7570/3162b98e.png 170w,\n/static/f67e51b2131d2821f9e1581e6399b0fd/f46e7/3162b98e.png 340w,\n/static/f67e51b2131d2821f9e1581e6399b0fd/ca1dc/3162b98e.png 680w,\n/static/f67e51b2131d2821f9e1581e6399b0fd/02d09/3162b98e.png 1020w,\n/static/f67e51b2131d2821f9e1581e6399b0fd/9d567/3162b98e.png 1360w,\n/static/f67e51b2131d2821f9e1581e6399b0fd/cc6c5/3162b98e.png 1552w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p><a href=\"http://pium.life\">http://pium.life</a> 로 접속하면 피움의 홈페이지가 나오기까지의 과정을 기록으로 남겨보려고 한다.</p>\n<blockquote>\n<p>본 과정은 서버 구축을 처음 하면서 과정을 이해하기위해 작성된 글입니다.</p>\n<p>빠르게 따라할 수 있는 설정 기반 글을 원한다면 마지막 목차인 정리를 확인해보시길 바랍니다.</p>\n</blockquote>\n<blockquote>\n<p>본 과정에서는 소량의 과금(?)이 존재합니다.\n(도메인 구입비용 : 약 4000원)</p>\n</blockquote>\n<h2>도메인 정하기</h2>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/beeec2ef08bc2096e099db73407a0997/649dd/8e211be2.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 62.94117647058823%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACf0lEQVR42nWRy2pVSRSG9xv0vKGfoYcOeuh7NI56It0jJwoi+AqCoGC32CCRiJpEAgoqrZi7MSExKt2ek4M58Vz22feqXdf9NbuSExV0wc/6V7Hqq6pV0TiTTAqNVoqyyJGiIk+TkKdrtRAoKZFSMIlHWGuYhigysvGAyaBPmaVE5+7uce2fLvNbfR687jP3+pD7mwchz2994sFm/8TPbR1y79VHFrYHzG9/YnFnyPm725y59oLfbixzbnaH6KcLT7k8t8uLt31edjJefkhY6qQhf8tP62fvhqx0Jvx88RHRrzP88PsCP55/QrS2n7HeK1jdz1npZix3U5Y7n7XUgo7V1m3PVKvdlI1eHrTey1jbT4naOckyw2mJVQJnFN4Z8AbvHL45GRfOGkxdYWSFqgVCuzDrWhQ4Z0NPVCtNlhfkRUlRllRCImuF0hqpDcb5APUelDYIWSOkxBiDbxq81UE0nqaBSAhBVVV473HOYe3RSe2Gtm5Dax180zRoc/TDc9tD/pjd4/Lif1x6+C9nZ3Z59j4maptbaNuslAoKG7UO8LCudThQ2YbOoAKnWeskXH28x+xKl3sbB/z5vMubfk5UFEW4zZfRQqa5dU12iE8PkVKysJuw+DYNTxRFiRISpw1OqTDzKI7jcJsTwJewY+9HH7CjDroW/LU64MrSCG8NcSZIcskkE8RpRa0MUZqkJ3ObQr5SCxx3sfko/PDfG0Our45pnA2gtJBkhSTNBUpbongyYZTX1MZ9G3gMdd5T5Ql3NkfcepXQWEtZSGRVI6qaspRHwNF4jFAGbT3fixaYCUUWD7m1PuTmxoSDXHHqdpdfZnqcur3P6dkeiTD8D7sPxL69HdBlAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='8e211be2' title='' src='/static/beeec2ef08bc2096e099db73407a0997/ca1dc/8e211be2.png' srcset='/static/beeec2ef08bc2096e099db73407a0997/e7570/8e211be2.png 170w,\n/static/beeec2ef08bc2096e099db73407a0997/f46e7/8e211be2.png 340w,\n/static/beeec2ef08bc2096e099db73407a0997/ca1dc/8e211be2.png 680w,\n/static/beeec2ef08bc2096e099db73407a0997/02d09/8e211be2.png 1020w,\n/static/beeec2ef08bc2096e099db73407a0997/649dd/8e211be2.png 1234w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<blockquote>\n<p>도메인을 구입하기 위해 도메인 호스팅 사이트 <a href=\"https://www.gabia.com/\">가비아</a>를 이용했다.</p>\n</blockquote>\n<p><code class=\"language-text\">pium.com</code> <code class=\"language-text\">pium.co.kr</code> <code class=\"language-text\">pium.net</code> 등등.\n서비스의 이름으로 자주 사용하는 도메인을 생성하고싶었으나 이미 존재하거나 가격이 너무 비싸다는 문제가 있었다.</p>\n<p>적당한 가격에 서비스의 이름을 가진 도메인인 <code class=\"language-text\">pium.life</code>를 선택했다. (1년 4000원)</p>\n<h2>도메인 설정하기</h2>\n<blockquote>\n<p>가비아 서비스를 기준으로 과정이 진행됩니다.</p>\n</blockquote>\n<p><code class=\"language-text\">3.123.123.123</code>과 같은 인스턴스 public ip 주소를 <code class=\"language-text\">pium.life</code>로 별칭을 지정해주자.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/5c39231cc02060595d5acd7d53964cac/89578/ce5d100b.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 61.76470588235294%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAC5klEQVR42lWSXWibZRiG3x144EBhJW2TbDNbp127Rvrflfbrmm5J6hKTJlmH3TrsrFG7H9I2azcROkUpIhOUquxEmGzN5oYeeCQigmeCMvBs4IlsrMGmNT+m+f7yNZd835aOPXBzv1zP877vc3CLTEElnVdRVQW5VKS0UWSjWEBTZVRFtpiilNA0lf8KOatnVqVSsdxQFTJ/3WPtwX1y+RwikEzxyswywWSKo7PLBGZTmCw0d4vw/C1Clr4lfOk7QskUwZnrhC7csHh4/iah5DJDp5fwvPkV3vPXENsPXmJPcBHb4AJO/4fYvR9Q61lgm3sa4Z5FtM4h2i4iWi+wrf9jno19zzOHv0YcOIN4OYFon0d0vYvoSCLaTMXeZ3T6S8LnPscf/xR//ArBqc/oH19k4PUrNAQWqB++TI00R/3xFP3XoecLg1rvVWq649j6p7FJSWx9CWr6EgjXQJyXhqZo9p1jn+cdnL1vYO+ZwCXFeeHQFA4pQcPlP3An7nDg1DVeXMzTehtcE3/y/P4I9t7T1PW+RW3v29T2TCJ2dx3DPTRBo3SSnZ0xHO0RnB1R7G0RnF2vYW+N4RpZIvITeD76mfroD+x6D+piv7Kj0U/TiSX2Dl/E0T2Os3sM4WgaYLfbw66WQez7pSdqkrA3H6a+UaKh7wTuszfZ45uhriXCc9Iy21vOYNt3EGfnKRwdYzjaojiaBxG+4Ci+wDG8R2OWP61R/KExgiOj+I/48fpfxReI4g1G8QUf9Y8EYnhGJhkMTzI0HEFkMqtks/9aOZPlkiVFldF1jbKuW65pGrpeplw2pW9xVdOATT755W98V+/y470MwjDKGIbxOKiVp7wa3mpVWZVXHkHycpm1DZ3U7ysIk5VKJVZXM2iavnU5l8uRTqeRZXmLZbNZVlZWttjm5iZra+usr/6DoSt889tDc0ODYrFIoVCwHq5uYrJ8Po+iKBbTdd2aMZk5V93UPJsfmX2z/gc2so9kBoADxAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='ce5d100b' title='' src='/static/5c39231cc02060595d5acd7d53964cac/ca1dc/ce5d100b.png' srcset='/static/5c39231cc02060595d5acd7d53964cac/e7570/ce5d100b.png 170w,\n/static/5c39231cc02060595d5acd7d53964cac/f46e7/ce5d100b.png 340w,\n/static/5c39231cc02060595d5acd7d53964cac/ca1dc/ce5d100b.png 680w,\n/static/5c39231cc02060595d5acd7d53964cac/02d09/ce5d100b.png 1020w,\n/static/5c39231cc02060595d5acd7d53964cac/89578/ce5d100b.png 1209w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>우측 상단의 <code class=\"language-text\">My 가비아</code> 탭으로 들어간다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/73e1f16d1334bd57f1a8ece74d6d0c21/9d8cf/48a0d2d6.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 60.58823529411765%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACAElEQVR42mWTy24UMRBF+99ZsuQH2PAD2aKs2LBAYgGLSIAg80j3pKfb7ber/LjIlQkMoaQrty3Lvve4ehjXgO+jwbxFzDqCc4HeNoQQsGkN7z2UUkgpYVkWWX+uCsAnQiDG/WHCj197DM55EDNqA0ptSInAzCLvHJgJtVZRKUXG1tpFFa0y0ArQMlohDOuyoKtv7ptijKil4Die8G1UcsDLqq3J+Gnv8Pp2hzcfHvDqdsK7zysGbSwe5wV9JMrgXJ9iGwulHYiLKFG+iBETi4G7yePmq8LNlwVvP454f7dgmE4LdrsjjPWIKcPaAOMCHucV0/QIbT2siwiRRc8HO59A9BS3cgQ4IhNh8D4K9A6/g885g4nhAuGsDGIMICKJmUu9OCT4EOGNw3IcsW0GynhJMoRI8hClVFGMCcwZxiVMi0GtBZ1Yrk3WdocJP+/3OCuLsGmcd3vYdcOyOUExOB+wKgVrnbjs6lF6LObyz2N0FIeHE3b7EadZwQfCPM3QxmM8nRGJMYTurrfERblkcRwSi65rM14cjtMZi7JIXBApizNt+gPm7jDCGgvnHEKI0pOdUUpZNlyXcxHn1cAFlvid6XX1+RCEGf9h2PuuM+yRlTbQepPLegVvsapNevXSiv8f2NtFaw3rnLCr/W8hkjiU/6Lo632ey9P3S7XahPlvQnGg8uehD80AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='48a0d2d6' title='' src='/static/73e1f16d1334bd57f1a8ece74d6d0c21/ca1dc/48a0d2d6.png' srcset='/static/73e1f16d1334bd57f1a8ece74d6d0c21/e7570/48a0d2d6.png 170w,\n/static/73e1f16d1334bd57f1a8ece74d6d0c21/f46e7/48a0d2d6.png 340w,\n/static/73e1f16d1334bd57f1a8ece74d6d0c21/ca1dc/48a0d2d6.png 680w,\n/static/73e1f16d1334bd57f1a8ece74d6d0c21/02d09/48a0d2d6.png 1020w,\n/static/73e1f16d1334bd57f1a8ece74d6d0c21/9d8cf/48a0d2d6.png 1216w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>우측의 <code class=\"language-text\">DNS 관리툴</code> 탭으로 들어간다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/a4cb9491393cae21332985fd64fb8c0d/a47a4/dbaa42b0.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 26.47058823529412%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA0ElEQVR42mWQi27DIAxF8/8fWqVNSgLBGDBwJrJJ1TZLR/KV314ee2DdHH5/MWqhacJKoQ3+0f8wBpzacdrRUki5sjgfOC9Frsj2XDn2DRUh5ZmQfyg3opmYPkz98sp6Jtyl7D6ySK44qQzgsZ2sR+JIjXesN07sZvrZ+r3W6JNO743RG80qooLmzCKS8D4wLWhlD4l3UJ6H4GJh9996+vMka4bmQkyJYoaWep8bJeLdydJ7p7V2N5xTzSpj/GwyOnX+1WxGGePDrPulrZEu4Quw+oXtMsdoBAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='dbaa42b0' title='' src='/static/a4cb9491393cae21332985fd64fb8c0d/ca1dc/dbaa42b0.png' srcset='/static/a4cb9491393cae21332985fd64fb8c0d/e7570/dbaa42b0.png 170w,\n/static/a4cb9491393cae21332985fd64fb8c0d/f46e7/dbaa42b0.png 340w,\n/static/a4cb9491393cae21332985fd64fb8c0d/ca1dc/dbaa42b0.png 680w,\n/static/a4cb9491393cae21332985fd64fb8c0d/02d09/dbaa42b0.png 1020w,\n/static/a4cb9491393cae21332985fd64fb8c0d/9d567/dbaa42b0.png 1360w,\n/static/a4cb9491393cae21332985fd64fb8c0d/a47a4/dbaa42b0.png 1421w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>도메인의 <code class=\"language-text\">설정</code> 탭으로 들어간다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/edf6fd8e323628c5351511474c4ae487/047c3/0b4d4be0.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 20.58823529411765%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAiklEQVR42qXM2wqDMBCE4bz/U7YFDcZojqZkk/oXhV6U4lUHPpiFZdQwWfS84nPBpYK/kq+FXNBuw7iE0uOI954z+86/UdZajDE8S2GxMyGE03E7H1hiIsVE7/1L65391ZmS8Fg3nHfkraBijCyzQd8G9H2g1UoVoYlQj14FEfkZ/JDWkNbPH5HGGy26Ntj5ZK52AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='0b4d4be0' title='' src='/static/edf6fd8e323628c5351511474c4ae487/ca1dc/0b4d4be0.png' srcset='/static/edf6fd8e323628c5351511474c4ae487/e7570/0b4d4be0.png 170w,\n/static/edf6fd8e323628c5351511474c4ae487/f46e7/0b4d4be0.png 340w,\n/static/edf6fd8e323628c5351511474c4ae487/ca1dc/0b4d4be0.png 680w,\n/static/edf6fd8e323628c5351511474c4ae487/02d09/0b4d4be0.png 1020w,\n/static/edf6fd8e323628c5351511474c4ae487/047c3/0b4d4be0.png 1208w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>DNS 관리 탭의 <code class=\"language-text\">설정</code> 혹은 <code class=\"language-text\">레코드 수정</code>에 들어간다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/be57907274a476d1261092d3bac97cd0/51f47/d830ba27.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 38.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNklEQVR42pWOS07DMBCGc6giIa7AissU0U2PQVgUCkskDoSEYNlCHnbiRzx+/WjcpoIdjPQp9mTm819dvbS4fG5w/rjH4mGPs+3/WWz3Zf/i6RNVbwiMZKwvdGo6MfdmxM/5HzvSEjRFVNM0QTiPlBOsMcg5gSvnDOfc8Z6RUoL3HkQOWmvE4EHOlX/8DcGXvcoRwcdYhkII4Ac2m3vc1jXq+g5CiDLI/cm5ImaGcYQxBj4EdEJCjgqZhTFGjlPScFlrsV6vcb1cYrW6QdM0JyERleRcwzAUYQgRvZAYlTokbLsezvvyOsuZ3W6HruuglCqpWcJCd0zIdykljNYgH9D2EmJQnAvV65fFW+tg6JB0TjBXPvaYWTafkRNaE/DeET56gvYJlYvAFDLSb8+fKySAHQw7vgE1NFLtl5QrkgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='d830ba27' title='' src='/static/be57907274a476d1261092d3bac97cd0/ca1dc/d830ba27.png' srcset='/static/be57907274a476d1261092d3bac97cd0/e7570/d830ba27.png 170w,\n/static/be57907274a476d1261092d3bac97cd0/f46e7/d830ba27.png 340w,\n/static/be57907274a476d1261092d3bac97cd0/ca1dc/d830ba27.png 680w,\n/static/be57907274a476d1261092d3bac97cd0/51f47/d830ba27.png 892w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>위와 같이 레코드를 추가하고 저장한다.</p>\n<blockquote>\n<p>CNAME 설정은 향후 서브도메인 설정을 위한 설정입니다.</p>\n</blockquote>\n<p>이제 <a href=\"http://pium.life\">http://pium.life</a> 로 접속하면 서버로 바로 접속할 수 있게된다. (SSH 접속이 아닌 HTTP 접속을 의미한다.)</p>\n<h2>환경 살펴보기</h2>\n<p>피움은 하나의 EC2에 프론트엔드, 백엔드의 배포를 모두 진행하려고한다.</p>\n<p>이를 위해서라면 서로 다른 포트에 서비스를 띄워둔 뒤 각 요청별로 포트를 분산시킬 필요가 있다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 555px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/6b66749ad542471689f2ca5ecb3a11d0/98c96/ee357fa5.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 51.17647058823529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABR0lEQVR42qWRz0oCURTG5w16l16jl2jRpmVvELQO3Lhq08Jdi2gj0qIokKIgLExjJPNPjjCjNn9sBmfuPb9wstRQjDrwce/9Fr/znXsM/liCLPSN/8DunSIXr8eMdPTtLweKzGviiej02nQrZEo7nLWPcMLOaqDMaFx6FILoz3elQquU56R9yE33dB6olGIwGBAEAb7v43oeQ/cNbAupliCMcM5zNDbXoLCHeAHqxUwBD70rilaeRMdToIhQr9ep1WqYppmetu3QaFhcX97i+IpWZpundQP2NwgBlcRLF5SOHIZhmm6ccqxRonATaAYJnga/dkczu4V+LNB5h7LloQWeY011pIlk+k3G4n1MO4rW9L0A24/o+eN8mnI3oNgdcjCE3T6Y8Qrgz8XMDTcx+krIBZB1oZ78Ejib+EuzzfoaegrimZE/AG3xAde3BmpZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='ee357fa5' title='' src='/static/6b66749ad542471689f2ca5ecb3a11d0/98c96/ee357fa5.png' srcset='/static/6b66749ad542471689f2ca5ecb3a11d0/e7570/ee357fa5.png 170w,\n/static/6b66749ad542471689f2ca5ecb3a11d0/f46e7/ee357fa5.png 340w,\n/static/6b66749ad542471689f2ca5ecb3a11d0/98c96/ee357fa5.png 555w' sizes='(max-width: 555px) 100vw, 555px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>때문에 위와 같은 흐름으로 요청이 진행되는 것이 최종 목표다!</p>\n<h3>EC2 보안규칙</h3>\n<p>우아한테크코스 과정에서 제공되는 EC2의 보안규칙은 다음과 같다.</p>\n<ul>\n<li>사내에서만 22번 포트 접속 가능</li>\n<li>80, 443은 열려있음</li>\n<li>이외의 포트는 열려있지 않음.</li>\n</ul>\n<p>우리가 흔히 개발을 하면서 사용하는 3000번 포트 혹은 8080번 포트를 통해 해당 서버에 접근하지 못한다는 이야기다.</p>\n<p>즉, 다시말해 pium.life:8080과 같은 접근이 안된다는 이야기다.</p>\n<p>인바운드 규칙에서 8080 혹은 3000번 포트를 열어버리는 방법도 있겠지만 보안 규칙에 손대지 않으면서 해결할 수 있는 방법을 찾아보자.</p>\n<h2>nginx로 포트포워딩하기</h2>\n<p>linux에 존재하는 <code class=\"language-text\">iptables</code> 명령어를 통해 서버 자체적으로 포트포워딩 환경을 구성할 수도 있지만 현재 피움은 하나의 서버에서 두개의 어플리케이션을 배포하고 있고, 도메인도 하나다.</p>\n<p>따라서 후에 설명할 서브도메인을 적용하기 위해서라도 nginx를 이용하기로 한다.</p>\n<h3>nginx 설치하기</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> nginx</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">systemctl status nginx</code></pre></div>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/62f73813a3dbce8bfdc5b39ca49641f1/1ed31/28e0139a.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 18.823529411764707%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAApUlEQVR42pWPOw+DMBCDI4TCkPJGKC8ULjQ0Qv3/f8/VZWBplw6f7FtsnziOA9ppGG/gyYMiIVIEEcE5h23bbu+9h1IKbduirmsIIb4504nwCqA3QScN6y1CCIV1XWGtxb7vMMYgxliCl2XBNE2FcRwxz3PxUkqInDPSM+HKFyhQaR+GoWjf90W7rrs9wyF8s3I4Ky+uqgqC23mNeig0jfz9xh98AJx/X27IEAMSAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='28e0139a' title='' src='/static/62f73813a3dbce8bfdc5b39ca49641f1/ca1dc/28e0139a.png' srcset='/static/62f73813a3dbce8bfdc5b39ca49641f1/e7570/28e0139a.png 170w,\n/static/62f73813a3dbce8bfdc5b39ca49641f1/f46e7/28e0139a.png 340w,\n/static/62f73813a3dbce8bfdc5b39ca49641f1/ca1dc/28e0139a.png 680w,\n/static/62f73813a3dbce8bfdc5b39ca49641f1/1ed31/28e0139a.png 974w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>이제 주소창에 인스턴스 ip 를 치고 접속하면 다음과 같이 nginx default 페이지를 볼 수 있다. </p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 663px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/9a3c9696e83150d8f8c8cc0df8288ade/5c8e6/9345764b.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 38.23529411764706%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABdUlEQVR42l1SyW7CQAzl/3+AOwc4IcQJCQ6glCxAEXBhEQ0TSlaSNAqJQlXIvMpuoRRLT1408+bZnkq328VsNsNqtWJsNhtst1us12vs93ssl0vM53Oux3EMsuv1irIsGRTfciklKrVaDfV6A+12G81mE61WC/1+H51Oh321WkWj0UCv10MURUxIF5+Nakx4Pp9RFAVOpxOyLPvn8zxHmqbsCUmSIAxDeJ6HIAgQhjFs2+GYzjGhqqowRgamr1NQPBwOoWkaFEWBruuYLxZQVQ26biAIjvB9H4fDAY5zgO87EMLk0dzGUaHXXNfB8Xhk0GvCsuC6Lquhmuvu4XnvyLIPVpnn1IFEmgJF8dQyLcQwDIzHY4xGI1Y3mUw4J5WapkNRdhgMLCgvJoSwWJlpFliuvrATn7hcrpDydynCErBtm+dCrRCoLarFccTzjKISUSSRJPJhIfKOm7ofQiF4Bo7jcJuUm+YbE/5Zecftu5SlvOOR8BvTY01zT91IgAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='9345764b' title='' src='/static/9a3c9696e83150d8f8c8cc0df8288ade/5c8e6/9345764b.png' srcset='/static/9a3c9696e83150d8f8c8cc0df8288ade/e7570/9345764b.png 170w,\n/static/9a3c9696e83150d8f8c8cc0df8288ade/f46e7/9345764b.png 340w,\n/static/9a3c9696e83150d8f8c8cc0df8288ade/5c8e6/9345764b.png 663w' sizes='(max-width: 663px) 100vw, 663px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<h3>80 포트 접속을 8080 포트로</h3>\n<blockquote>\n<p>해당 과정은 8080포트에 애플리케이션이 구동중인 상태에서 진행됩니다.\n다음 명령어로 8080포트에서 애플리케이션이 구동중인지 확인한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">lsof</span> <span class=\"token parameter variable\">-i</span> tcp:8080</code></pre></div>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 598px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/51a5f82dfc1fcb417df2c1222b0262f7/02e46/1573063d.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 9.411764705882353%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAdklEQVR42j2Nuw4DIRADoULKidtADqTwWJETtBTU+f/fcrQUKUaWC48VfyuO/gA5gjEGzjkQPZFzwX1/UGvFnBNrLaSU4L1HjHFDRFBKQWv9R/GbcR4neu/IOe8U8XW9UEoBM2OMscciky4nQmtti621u4cQ8AO5aTJ2JxUUHQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='1573063d' title='' src='/static/51a5f82dfc1fcb417df2c1222b0262f7/02e46/1573063d.png' srcset='/static/51a5f82dfc1fcb417df2c1222b0262f7/e7570/1573063d.png 170w,\n/static/51a5f82dfc1fcb417df2c1222b0262f7/f46e7/1573063d.png 340w,\n/static/51a5f82dfc1fcb417df2c1222b0262f7/02e46/1573063d.png 598w' sizes='(max-width: 598px) 100vw, 598px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n</blockquote>\n<p>이제 nginx 설정파일을 작성하여 80포트로 오는 요청을 8080포트로 전환시켜본다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token builtin class-name\">cd</span> /etc/nginx/sites-available/\n\n<span class=\"token function\">sudo</span> <span class=\"token function\">vi</span> default</code></pre></div>\n<blockquote>\n<p>주석처리 되어있는 부분은 제외하고 코드로 표현합니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 변경 전 파일내용</span>\nserver <span class=\"token punctuation\">{</span>\n        listen <span class=\"token number\">80</span> default_server<span class=\"token punctuation\">;</span>\n        listen <span class=\"token punctuation\">[</span>::<span class=\"token punctuation\">]</span>:80 default_server<span class=\"token punctuation\">;</span>\n\n        root /var/www/html<span class=\"token punctuation\">;</span>\n\n        index index.html index.htm index.nginx-debian.html<span class=\"token punctuation\">;</span>\n\n        server_name _<span class=\"token punctuation\">;</span>\n\n        location / <span class=\"token punctuation\">{</span>\n                try_files <span class=\"token variable\">$uri</span> <span class=\"token variable\">$uri</span>/ <span class=\"token operator\">=</span><span class=\"token number\">404</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>처음 파일을 열어보면 위와같이 설정되어있을 것이다.</p>\n<p>최대한 간략하게 포트를 변경한다는 목적만 달성해보기 위해 다음 내용들을 수정해보자.</p>\n<ul>\n<li><code class=\"language-text\">root /var/www/html;</code> 주석처리</li>\n<li><code class=\"language-text\">index index.html index.htm index.nginx-debian.html;</code> 주석처리</li>\n<li>\n<p><code class=\"language-text\">location / { ... }</code> 내부 내용에 다음 내용 추가</p>\n<ul>\n<li><code class=\"language-text\">proxy_set_header Host $host:$server_port;</code></li>\n<li><code class=\"language-text\">proxy_set_header X-Real-IP $remote_addr;</code></li>\n<li><code class=\"language-text\">proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</code></li>\n<li><code class=\"language-text\">proxy_pass http://127.0.0.1:8080;</code></li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 변경된 파일내용</span>\nserver <span class=\"token punctuation\">{</span>\n        listen <span class=\"token number\">80</span> default_server<span class=\"token punctuation\">;</span>\n        listen <span class=\"token punctuation\">[</span>::<span class=\"token punctuation\">]</span>:80 default_server<span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\"># root /var/www/html;</span>\n\n        <span class=\"token comment\"># index index.html index.htm index.nginx-debian.html;</span>\n\n        server_name _<span class=\"token punctuation\">;</span>\n\n        location / <span class=\"token punctuation\">{</span>\n                proxy_set_header Host <span class=\"token variable\">$host</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">$server_port</span><span class=\"token punctuation\">;</span>\n                proxy_set_header X-Real-IP <span class=\"token variable\">$remote_addr</span><span class=\"token punctuation\">;</span>\n                proxy_set_header X-Forwarded-For <span class=\"token variable\">$proxy_add_x_forwarded_for</span><span class=\"token punctuation\">;</span>\n                proxy_pass http://127.0.0.1:8080<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위와같이 설정파일을 수정했다면 다음 명령어를 수행해 nginx를 다시 시작한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> systemctl restart nginx</code></pre></div>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 604px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/eef9247c8964e484681e7dfae0a0e86b/1994c/232c6d5d.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 28.235294117647058%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1ElEQVR42o1QyaqEQBDr//8jBfEg6FkvgrjhLi4XD+5mSEGD8B7DFISUVZikWpmmCcuyYNs2HMeB53mCIAjg+z4Mw4DruljXFaz7vvE8z79gqaqqkGUZkiRBmqZo2xZN06AsSyzLgiiKRJxCv5Tquk5EpmkSzPOMuq4xjqOIcs953/fS04x9nueyH4ZBmIF4heLPTFkUhQjpdFwex4Ft24TP8xSw3/dd5uT3N69QcRzLyeQwDOVEgqlpRKYRmQk5o6l+sz8nX9cFDSagi+7fyd749p4fy07GAzZ6YT4AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='232c6d5d' title='' src='/static/eef9247c8964e484681e7dfae0a0e86b/1994c/232c6d5d.png' srcset='/static/eef9247c8964e484681e7dfae0a0e86b/e7570/232c6d5d.png 170w,\n/static/eef9247c8964e484681e7dfae0a0e86b/f46e7/232c6d5d.png 340w,\n/static/eef9247c8964e484681e7dfae0a0e86b/1994c/232c6d5d.png 604w' sizes='(max-width: 604px) 100vw, 604px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>스프링부트 애플리케이션을 실행중이였다면 위와같은 Whitelabel Error Page를 확인할 수 있을것이다.</p>\n<h2>서브도메인 구성하기</h2>\n<p>이제 80포트에서 8080포트로 요청을 변환하는 과정은 성공했다.</p>\n<p>하나의 서버에 프론트엔드, 백엔드 코드가 같이 띄워져야하므로 서브도메인을 통해 페이지와 API를 구분해줘야한다.</p>\n<h3>index 파일 지정하기 - default 파일 수정</h3>\n<p>프론트에서 빌드 산출물로 나온 index.html을 기본 페이지로 참고하도록 설정하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token builtin class-name\">cd</span> /etc/nginx/sites-available/\n\n<span class=\"token function\">sudo</span> <span class=\"token function\">vi</span> default</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 변경 전 설정내용</span>\nserver <span class=\"token punctuation\">{</span>\n        listen <span class=\"token number\">80</span> default_server<span class=\"token punctuation\">;</span>\n        listen <span class=\"token punctuation\">[</span>::<span class=\"token punctuation\">]</span>:80 default_server<span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\"># root /var/www/html;</span>\n\n        <span class=\"token comment\"># index index.html index.htm index.nginx-debian.html;</span>\n\n        server_name _<span class=\"token punctuation\">;</span>\n\n        location / <span class=\"token punctuation\">{</span>\n                proxy_set_header Host <span class=\"token variable\">$host</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">$server_port</span><span class=\"token punctuation\">;</span>\n                proxy_set_header X-Real-IP <span class=\"token variable\">$remote_addr</span><span class=\"token punctuation\">;</span>\n                proxy_set_header X-Forwarded-For <span class=\"token variable\">$proxy_add_x_forwarded_for</span><span class=\"token punctuation\">;</span>\n                proxy_pass http://127.0.0.1:8080<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>기존에 80포트를 8080포트로 포워딩시켜주는 설정을 바꿔준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 변경 후 설정내용</span>\nserver <span class=\"token punctuation\">{</span>\n        listen <span class=\"token number\">80</span> default_server<span class=\"token punctuation\">;</span>\n        listen <span class=\"token punctuation\">[</span>::<span class=\"token punctuation\">]</span>:80 default_server<span class=\"token punctuation\">;</span>\n\n        root /var/www/html<span class=\"token punctuation\">;</span>\n\n        index index.html<span class=\"token punctuation\">;</span>\n\n        server_name pium.life<span class=\"token punctuation\">;</span>\n\n        location / <span class=\"token punctuation\">{</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이제 pium.life로 접속하면 <code class=\"language-text\">/var/www/html</code> 경로에 있는 <code class=\"language-text\">index.html</code>을 참조하도록 설정되었다.</p>\n<p>위 설정에 따르면 <code class=\"language-text\">index.html</code> 및 <code class=\"language-text\">bundle.js</code>, <code class=\"language-text\">assets</code> 등의 프론트 리소스들은 서버의 <code class=\"language-text\">/var/www/html</code>를 기준으로 위치시키면 된다.</p>\n<blockquote>\n<p>빌드 산출물 및 CD와 관련된 내용은 본 게시글에서 다루지 않습니다.</p>\n</blockquote>\n<h3>API 서버 지정하기 - api_config 파일 만들기</h3>\n<p><a href=\"http://api.pium.life\">http://api.pium.life</a> 로 API를 호출하도록 구성해보자.</p>\n<p>nginx는 기본적으로 <code class=\"language-text\">/etc/nginx/sites-enabled</code> 경로에 있는 파일들을 참고하여 설정파일에 적용한다.</p>\n<blockquote>\n<p><code class=\"language-text\">/etc/nginx/nginx.conf</code> 파일의 60번째 줄 참고</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 547px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/03d7a15ebc7bea96de5efdc6e60d72a2/25257/f4ceb33e.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 73.52941176470587%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABg0lEQVR42p1U207jQAz12J5bWpImBbVRuwqsdovafaDfwv//y0HjQBNWgAoPR8dJfDkee0JNIigTiAgUA2jVgOoGuW3RbzbY7/cYhgG73Q7b7RZd15mtqmPM/2jzlJC5ArsMcgznFM7YXVB85vaHmCtkWUL9FiwtVNdQ3VjiT4M/wrqaEjpOEImo5c3BfS9ZwWrWMlUZuVvhedeBmH+WdH6GznmItmCprX3m5fcT3i4IXqahpHRCTIcR8Q9CeADz4nq1TSbIRWFCiPcI4RdCfID6Ht73UH/3s5ZHhUdTVhSGOCDE3whhgGgH5mxFC4+oZkjG74ZSVkSkAcvNyOZY7NraFlm9fmvNLj4jv9ndeIbTHi5sIGU4Y8X4yhnu2uHMFQovrYpNmYvC2iCytiJT4BfJu3eLrXAqICZ4VXivUBV4LwghQETsDhe+am0oEWgg6F7x+PcRT09nnE7/cDwecTgcDOfzGX3ff32XqxzHh6LUE5wnU5RzRozR7MIppcu7z34QL1c+PLyNOKWUAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='f4ceb33e' title='' src='/static/03d7a15ebc7bea96de5efdc6e60d72a2/25257/f4ceb33e.png' srcset='/static/03d7a15ebc7bea96de5efdc6e60d72a2/e7570/f4ceb33e.png 170w,\n/static/03d7a15ebc7bea96de5efdc6e60d72a2/f46e7/f4ceb33e.png 340w,\n/static/03d7a15ebc7bea96de5efdc6e60d72a2/25257/f4ceb33e.png 547w' sizes='(max-width: 547px) 100vw, 547px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n</blockquote>\n<p>다음 과정을 통해 서브도메인 설정을 해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token builtin class-name\">cd</span> /etc/nginx/sites-available\n\n<span class=\"token function\">sudo</span> <span class=\"token function\">vi</span> api_config</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># api_config 파일 내용</span>\nserver <span class=\"token punctuation\">{</span>\n        listen <span class=\"token number\">80</span><span class=\"token punctuation\">;</span>\n        listen <span class=\"token punctuation\">[</span>::<span class=\"token punctuation\">]</span>:80<span class=\"token punctuation\">;</span>\n\n        server_name api.pium.life<span class=\"token punctuation\">;</span>\n        \n        location / <span class=\"token punctuation\">{</span>\n                proxy_set_header Host <span class=\"token variable\">$host</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">$server_port</span><span class=\"token punctuation\">;</span>\n                proxy_set_header X-Real-IP <span class=\"token variable\">$remote_addr</span><span class=\"token punctuation\">;</span>\n                proxy_set_header X-Forwarded-For <span class=\"token variable\">$proxy_add_x_forwarded_for</span><span class=\"token punctuation\">;</span>\n\n                proxy_pass http://127.0.0.1:8080<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">server_name</code> 옵션을 통해 api.pium.life 라는 도메인으로 접근하는 요청을 확인하고, 맞다면 8080 포트로 변경한다.</p>\n<p>위와 같이 파일을 작성했으면 <code class=\"language-text\">sites-enabled</code> 경로에 soft link(바로가기)를 생성한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">ln</span> <span class=\"token parameter variable\">-s</span> /etc/nginx/sites-available/api_config /etc/nginx/sites-enabled/api_config</code></pre></div>\n<p>이제 nginx를 재시작하여 설정을 적용해보자.</p>\n<blockquote>\n<p>💡 Tip : <code class=\"language-text\">nginx -t</code> 명령어를 통해 현재 설정파일이 정상적으로 작성되었는지 확인할 수있다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 545px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/b33f0caf9870e4f0864cfa6f8ea7af4d/f2ede/10d7627b.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 10.588235294117647%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAbklEQVR42k2NyQpDIRRDLS3igC3uBHFWHP7//1K8q7cICYcDYVJKPGOMgVIKIQTUWtF7p91ag3MO1loIIaC1Ju825xwf/gZ7MbA5J8nee+y9cc6hzjkTizFirUX8ZoxB/j1KKaGUgtEH6ij4/gz+iCQzrFRZETQAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='10d7627b' title='' src='/static/b33f0caf9870e4f0864cfa6f8ea7af4d/f2ede/10d7627b.png' srcset='/static/b33f0caf9870e4f0864cfa6f8ea7af4d/e7570/10d7627b.png 170w,\n/static/b33f0caf9870e4f0864cfa6f8ea7af4d/f46e7/10d7627b.png 340w,\n/static/b33f0caf9870e4f0864cfa6f8ea7af4d/f2ede/10d7627b.png 545w' sizes='(max-width: 545px) 100vw, 545px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n</blockquote>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/0b93d643e5673d6286e16237ce61a080/833a5/04601361.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 31.176470588235293%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA+0lEQVR42oWQWWuDUBCF/WdNaB9rmpY2CQkN9G9Wn+yjIObRBVQEcV/AXfGUuWBIpNCBj7lzmDncGW63P2G3P+J4OoPfvIJ/ecMzvwW/2eL944DP8xfTH1aPWK2f/oWTJAmCIECSfiCKImRZhqqqUC8XKIqCb0FAXhSgmKYJfwXpM1yapvA870oURQiCAGEYwvd9mKaJoijQNA3qukZZlgyqKVdVdWfOkYHrusyMTMiM3nmeI45jNkSGM6RRX5ZlLNP8naFt2zAMA47jQNd1aJoGy7KQJMkVGqZNyGD5o2Vw4zhiGAZG13Xo+55BK7VtyzTKc019tzdb3vUXn4Khs55N4kcAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='04601361' title='' src='/static/0b93d643e5673d6286e16237ce61a080/ca1dc/04601361.png' srcset='/static/0b93d643e5673d6286e16237ce61a080/e7570/04601361.png 170w,\n/static/0b93d643e5673d6286e16237ce61a080/f46e7/04601361.png 340w,\n/static/0b93d643e5673d6286e16237ce61a080/ca1dc/04601361.png 680w,\n/static/0b93d643e5673d6286e16237ce61a080/833a5/04601361.png 681w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p><a href=\"http://api.pium.life\">http://api.pium.life</a> 로 접속하면 API로 연결되는것을 확인할 수 있다.</p>\n<h2>정리</h2>\n<ul>\n<li>8080 포트에 API 애플리케이션을 실행한다.</li>\n<li>도메인 구입 및 A 레코드, CNAME을 설정한다.</li>\n<li>nginx를 설치한다.</li>\n<li>프론트 빌드 산출물을 <code class=\"language-text\">/var/www/html</code> 경로에 준비한다. (index.html, bundle.js, assets 등)</li>\n<li>서브도메인 및 포트포워딩 설정한다.</li>\n</ul>\n<h3>nginx 설정 명령어 따라가기</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># nginx 설치</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> nginx\n\n<span class=\"token comment\"># default 파일 수정</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">vi</span> /etc/nginx/sites-available/default</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># /etc/nginx/sites-available/default 파일 내용</span>\nserver <span class=\"token punctuation\">{</span>\n        listen <span class=\"token number\">80</span> default_server<span class=\"token punctuation\">;</span>\n        listen <span class=\"token punctuation\">[</span>::<span class=\"token punctuation\">]</span>:80 default_server<span class=\"token punctuation\">;</span>\n\n        root /var/www/html<span class=\"token punctuation\">;</span>\n\n        index index.html<span class=\"token punctuation\">;</span>\n\n        server_name pium.life<span class=\"token punctuation\">;</span>\n\n        location / <span class=\"token punctuation\">{</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># api_config 파일 작성</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">vi</span> /etc/nginx/sites-available/api_config</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># api_config 파일 내용</span>\nserver <span class=\"token punctuation\">{</span>\n        listen <span class=\"token number\">80</span> default_server<span class=\"token punctuation\">;</span>\n        listen <span class=\"token punctuation\">[</span>::<span class=\"token punctuation\">]</span>:80 default_server<span class=\"token punctuation\">;</span>\n\n        root /var/www/html<span class=\"token punctuation\">;</span>\n\n        index index.html<span class=\"token punctuation\">;</span>\n\n        server_name pium.life<span class=\"token punctuation\">;</span>\n\n        location / <span class=\"token punctuation\">{</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># nginx 재시작 및 설정적용</span>\n<span class=\"token function\">sudo</span> systemctl restart nginx</code></pre></div>\n<h2>Reference</h2>\n<p><a href=\"https://jminie.tistory.com/110\">https://jminie.tistory.com/110</a></p>\n<p><a href=\"https://customer.gabia.com/manual/domain/287/1201\">https://customer.gabia.com/manual/domain/287/1201</a></p>","frontmatter":{"title":"피움의 배포과정","date":"July 18, 2023","update":"July 18, 2023","tags":["배포","인프라"],"series":null},"fields":{"slug":"/pium-deploy-step/","readingTime":{"minutes":10.37}}},"seriesList":{"edges":[{"node":{"id":"28f1d87e-d3fc-5567-8531-57649652864f","fields":{"slug":"/sprint-idea/"},"frontmatter":{"title":"구글 스프린트 기반 아이디어 도출"}}},{"node":{"id":"4a9246fb-171b-5973-88fc-864034e78afd","fields":{"slug":"/blog-starter/"},"frontmatter":{"title":"피움 블로그 생성과정"}}},{"node":{"id":"c826ce0e-1ea7-517c-8d19-84e90a59a798","fields":{"slug":"/jenkins-setting/"},"frontmatter":{"title":"젠킨스 설치하기"}}},{"node":{"id":"a387bf4f-567f-50e7-b6a7-99a1a1c8971b","fields":{"slug":"/jpa-notnull-nullable/"},"frontmatter":{"title":"@NotNull과 nullable = false는 어떤 차이가 있을까?"}}},{"node":{"id":"a78e224b-b711-5071-8e90-013d6f4bebc3","fields":{"slug":"/pium-deploy-step/"},"frontmatter":{"title":"피움의 배포과정"}}}]},"previous":{"fields":{"slug":"/jpa-notnull-nullable/"},"frontmatter":{"title":"@NotNull과 nullable = false는 어떤 차이가 있을까?"}},"next":null},"pageContext":{"id":"a78e224b-b711-5071-8e90-013d6f4bebc3","series":null,"previousPostId":"a387bf4f-567f-50e7-b6a7-99a1a1c8971b","nextPostId":null}},"staticQueryHashes":[],"slicesMap":{}}