{"componentChunkName":"component---src-templates-post-jsx","path":"/tomcat-thread-config/","result":{"data":{"site":{"siteMetadata":{"title":"pium.log"}},"markdownRemark":{"id":"08c9daf0-2344-52a9-8c68-31ac04c24ff0","excerpt":"이 글은 우테코 피움팀 크루 '주노'가 작성했습니다. 서론 우아한테크코스 레벨4 5차 데모데이 요구사항으로부터 Tomcat Thread의 적절한 설정값에 대해 고민하게 되었다.  현재 피움 서비스는 Tomcat의 Thread 값을 어느정도로 설정해야할까? 다양한 상황을 고려해보고 적절한 개수로 설정해보자. 알아보기 요구사항에서 주어진 Tomcat의 설정값…","html":"<blockquote>\n<p>이 글은 우테코 피움팀 크루 '<a href=\"https://github.com/Choi-JJunho\">주노</a>'가 작성했습니다.</p>\n</blockquote>\n<h2>서론</h2>\n<p>우아한테크코스 레벨4 5차 데모데이 요구사항으로부터 Tomcat Thread의 적절한 설정값에 대해 고민하게 되었다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/6e4fb8f021a9c880dda146a72e343bf8/78f36/b06631fa.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 32.94117647058823%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyElEQVR42qVRywrCMBDM//+AePEu6MGDB+8i3lRQvFYsta/ENn3Tx+gEWhC9qAvD7G4ysxsiVssJ5tMxFrMR7uoGRtu26LruBYye+/wTxPm0xWG3wXG/RpbGb8JvQ0SRhtYJsqyAlApKKfi+jzAM4XneUGutTU9KiTiOTR4EgamZE2VZQlB0sSzY9hWu6yJN06d5hjzPB2aPl1n352SiKIqhV9c1RJIkZhIn9JtR/POTaeg4jjEj82lN0/xuSDE3qqrKgD/8TzwAHlsfIjrTHxcAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='b06631fa' title='' src='/static/6e4fb8f021a9c880dda146a72e343bf8/ca1dc/b06631fa.png' srcset='/static/6e4fb8f021a9c880dda146a72e343bf8/e7570/b06631fa.png 170w,\n/static/6e4fb8f021a9c880dda146a72e343bf8/f46e7/b06631fa.png 340w,\n/static/6e4fb8f021a9c880dda146a72e343bf8/ca1dc/b06631fa.png 680w,\n/static/6e4fb8f021a9c880dda146a72e343bf8/02d09/b06631fa.png 1020w,\n/static/6e4fb8f021a9c880dda146a72e343bf8/9d567/b06631fa.png 1360w,\n/static/6e4fb8f021a9c880dda146a72e343bf8/78f36/b06631fa.png 2056w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>현재 피움 서비스는 Tomcat의 Thread 값을 어느정도로 설정해야할까?</p>\n<p>다양한 상황을 고려해보고 적절한 개수로 설정해보자.</p>\n<h2>알아보기</h2>\n<p>요구사항에서 주어진 Tomcat의 설정값이 각각 무엇을 의미하는지 알아보자.</p>\n<h3>server.tomcat.threads.max</h3>\n<p>HTTP 요청을 처리하기 위해 사용할 수 있는 최대 작업 스레드 수를 설정한다.\n기본값은 <strong>200</strong>으로 200개의 스레드를 사용하여 동시에 요청을 처리한다는 의미다.</p>\n<h3>server.tomcat.max-connections</h3>\n<p>Tomcat이 동시에 처리할 수 있는 최대 클라이언트 연결 수를 정의한다.\n기본값은 <strong>8192</strong>이다.</p>\n<h3>server.tomcat.accept-count</h3>\n<p>모든 작업 스레드가 사용 중일 때 Tomcat이 수용 가능한 상태에서 대기 중인 TCP 연결의 최대 수를 나타낸다.\n기본값은 <strong>100</strong>이다.</p>\n<p>각 설정값이 어떤 부분인지 그림으로 표현하면 다음과 같다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/b61898383fd8c6dd8ec1744a1abc9132/986a5/e91ada8d.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 50.588235294117645%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB7klEQVR42pWSS2sTURiGp6A/IeJGEAx0EQoiVcS6UBdu1J0Lf4J0oUSUrt1LQYReNHiBqgVTuhGtJW6ESahImhjFxiSTOMkktXM1kwshl6dzRgNG0OIH7+FcvvOc95zvSPwWvV6PQqFANpvFtm1arRbNZnNPNRoNut2uz5BEMxgM/IGu68iyTDwep1gsomkalUrlryqXy75EnqIovgGp3+8jJEJA2u02/xNDM67r+vARh1q1SknJU1OLNGwT15MIQ9+hrORoOiZ1U/fzxcGZz1uoZY2626LtuVMFMJ1Ok0gkyOULPuja3acEri4QnFnmxK37uJbO4mqMA9OLjN98TDD8kE9fsqQ2k0yGAlw8M87pY4d4EHmEZVlI+XyeVCpFrqCQ3pC5cieKNL2GNBMnEI5S3Mpw+8krpOsxxm6sMxZe4+07mdj6GlNBifNH9zF1RCKyMItpOaNX3q7VkN9/YD66zNzKc6Kv34hFvnqHzb145s0tEVmJ0ul0SSU3mDgocTa0n1OHJebvzWLZHlDAhkUplUpecuefRRjmJjc/cvL4BJcvTXLhXIiXq0t83zFGHYoqqaqKZVqYholhGP67mKbom7/mTH9sWzbadpV0KcO3mkYup/x8wz8/tuM4Pkhs2ksCWnd+4NiW/236gwG72r66OJ/izZsAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='e91ada8d' title='' src='/static/b61898383fd8c6dd8ec1744a1abc9132/ca1dc/e91ada8d.png' srcset='/static/b61898383fd8c6dd8ec1744a1abc9132/e7570/e91ada8d.png 170w,\n/static/b61898383fd8c6dd8ec1744a1abc9132/f46e7/e91ada8d.png 340w,\n/static/b61898383fd8c6dd8ec1744a1abc9132/ca1dc/e91ada8d.png 680w,\n/static/b61898383fd8c6dd8ec1744a1abc9132/02d09/e91ada8d.png 1020w,\n/static/b61898383fd8c6dd8ec1744a1abc9132/9d567/e91ada8d.png 1360w,\n/static/b61898383fd8c6dd8ec1744a1abc9132/986a5/e91ada8d.png 1666w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<h2>서비스 분석하기</h2>\n<p>피움 서비스는 트래픽이 몰리는 서비스가 아니다.\n사용자의 개인화된 서비스를 제공하고 있기 때문에 다량의 데이터를 동시에 처리할 일이 거의 없다.</p>\n<p>대량의 트래픽, 동시성에 대한 여지가 있는 커뮤니티 기능도 존재하지 않는다.</p>\n<p>하지만 실제로 운영한다면 달라지지 않을까?</p>\n<p>현재 운영중인 유사한 서비스를 분석해보자</p>\n<h3>MAU 분석</h3>\n<blockquote>\n<p>이어지는 내용은 다음과 같은 용어를 사용합니다.</p>\n<p><code class=\"language-text\">MAU(Monthly Active User)</code>: 30일 동안 앱을 사용하는 순 유저 수</p>\n<p><code class=\"language-text\">DAU(Daily Active User)</code>: 하루동안 앱을 사용하는 순 유저 수</p>\n<p><code class=\"language-text\">MCU(Max Current User)</code>: 최대 동시 접속자</p>\n<p><code class=\"language-text\">ACU(Average Current User)</code>: 평균 접속자</p>\n</blockquote>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/20c2817e33af3d12034b23021c5914d8/2a278/e43c9ccc.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 10%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAfUlEQVR42i2N2w6CMBBE+f/fM4ogKLFeegG7pcZGgzm2hod5mNmdOdXFRNrB4eTDIy745xc9JeqjQeVb8SUv6s8jSgt+fuMlISFhXaDpFIdeYa2nKqVNe8X6/LQO3scXu05zusnfT3PJlwzOEB2QmOHroLHCdj9QNwNaT/wAqtKWVkRewnkAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='e43c9ccc' title='' src='/static/20c2817e33af3d12034b23021c5914d8/ca1dc/e43c9ccc.png' srcset='/static/20c2817e33af3d12034b23021c5914d8/e7570/e43c9ccc.png 170w,\n/static/20c2817e33af3d12034b23021c5914d8/f46e7/e43c9ccc.png 340w,\n/static/20c2817e33af3d12034b23021c5914d8/ca1dc/e43c9ccc.png 680w,\n/static/20c2817e33af3d12034b23021c5914d8/02d09/e43c9ccc.png 1020w,\n/static/20c2817e33af3d12034b23021c5914d8/9d567/e43c9ccc.png 1360w,\n/static/20c2817e33af3d12034b23021c5914d8/2a278/e43c9ccc.png 2430w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p><a href=\"https://www.similarweb.com/website/groo.pro/#traffic\">유사 서비스 MAU 참고 사이트</a></p>\n<p>해당 지표를 확인했을 때 월 평균 방문자수는 약 3만 8천명으로 책정된다.</p>\n<p>분당, 초당 요청 횟수에 대해서는 자세하게 확인할 수 없으니 대략적으로 값을 판단해보자.</p>\n<h4>추정값 계산</h4>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/dc713e6d40c5b73c5a1a141fde221959/dce07/3c4d6f9c.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 41.1764705882353%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABF0lEQVR42o2R246DMAxE+f+v5FYJaEuhQAmY4p2TLUh9WW0ky449dmacZBiG+XK5bF3XmWJTbHmeW13XdrvdrGkae7/f5u5/2eq/p0yWZbHX6+Xyvq6rE0/T5CGEaPM8+z/O/vFV8nw+rSxLH8fRxdKLovAsy/x6vbpY+v1+98fj4WmaxlgqYg0cfer/Hmg6sJMs37btZEYOUzkazFEA7sBg1L4Gipn1fR9ZwACWh1Tu2mPMMRwMxkqok2/bFsxOjx6rEr1s0AaEP5oB8BB3/HHHjh0jn1iYnZ7IUAV+8fwUYmQgHxbY5/Vo3BlCzKEmlVFyZKjpo5a/aNGhqqqgOHqxDZITVD9zaoyxPiOAByO5xLPyu9hnP+gsaMD7wtrwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='3c4d6f9c' title='' src='/static/dc713e6d40c5b73c5a1a141fde221959/ca1dc/3c4d6f9c.png' srcset='/static/dc713e6d40c5b73c5a1a141fde221959/e7570/3c4d6f9c.png 170w,\n/static/dc713e6d40c5b73c5a1a141fde221959/f46e7/3c4d6f9c.png 340w,\n/static/dc713e6d40c5b73c5a1a141fde221959/ca1dc/3c4d6f9c.png 680w,\n/static/dc713e6d40c5b73c5a1a141fde221959/02d09/3c4d6f9c.png 1020w,\n/static/dc713e6d40c5b73c5a1a141fde221959/9d567/3c4d6f9c.png 1360w,\n/static/dc713e6d40c5b73c5a1a141fde221959/dce07/3c4d6f9c.png 2208w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>한달에 3만 8천명 정도의 트래픽이 발생한다고 가정했을 때 단순 계산을 해보면 초당 0.015개의 요청이 발생한다고 생각해볼 수 있다...</p>\n<p>24시간 내내가 아니라 하루 12시간으로 쳐줘도 초당 0.03개의 요청이 발생한다고 유추해볼 수 있다.</p>\n<h2>분석하기</h2>\n<p>기존 서비스의 사용자 추이를 분석해봐도 초기에 생각한 것 처럼 많은 트래픽은 몰리지 않음을 확인할 수 있었다.</p>\n<p>만약 위에서 계산했던 값을 토대로 하루 평균 요청량이 1분 내로 몰린다고 하더라도 초당 21건의 요청이 오는 꼴이다.</p>\n<p>이 값은 현재 Tomcat의 기본 사양으로도 충분한 요청이다.\n(maxThreads = 200)</p>\n<p>그래도 실제로 요청이 왔을 때 정상적으로 처리하는지 확인해볼 필요는 있다.</p>\n<h2>Jmeter</h2>\n<p>Apache jmeter를 사용하여 서버가 요청을 처리하는 성능을 알아보자.</p>\n<p>피움 서비스에서 비로그인 상태로 이용할 수 있는 서비스로 식물 검색기능이 있다.</p>\n<p>로그인 이후 수행되는 서비스 중에서 트래픽이 빈번하게 발생할 것으로 우려되는 기능은 없다고 판단했다. (반려 식물 등록, 수정, 삭제, 타임라인 확인, 물주기 등)</p>\n<p>따라서 서비스에서 가장 빈번하게 일어날 것이라고 예상되는 식물 검색기능을 기준으로 처리량을 분석하고자 한다.</p>\n<h3>TPS</h3>\n<blockquote>\n<p>TPS란 Transaction per Second의 약자로서, 1초당 처리할 수 있는 트랜잭션의 개수를 의미한다.\n다시말해 1초에 서비스가 처리할 수 있는 요청의 양의 개수를 의미한다.</p>\n</blockquote>\n<p>현재 가장 직관적으로 판별할 수 있는 값이라고 판단하여 TPS를 성능의 지표로 사용하기로 했다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/e86bac89b71c0f8751f3037048097d80/93333/d86c4efb.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 7.0588235294117645%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAMklEQVR42mPw8PL57+rh+d/ZzeO/CxC7unv9d/PwAorhx+5AfSDs4Q2kPb3BbE8fv/8Auq0k3vW1d4sAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='d86c4efb' title='' src='/static/e86bac89b71c0f8751f3037048097d80/ca1dc/d86c4efb.png' srcset='/static/e86bac89b71c0f8751f3037048097d80/e7570/d86c4efb.png 170w,\n/static/e86bac89b71c0f8751f3037048097d80/f46e7/d86c4efb.png 340w,\n/static/e86bac89b71c0f8751f3037048097d80/ca1dc/d86c4efb.png 680w,\n/static/e86bac89b71c0f8751f3037048097d80/02d09/d86c4efb.png 1020w,\n/static/e86bac89b71c0f8751f3037048097d80/9d567/d86c4efb.png 1360w,\n/static/e86bac89b71c0f8751f3037048097d80/93333/d86c4efb.png 2174w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>1건의 요청에 대해 TPS가 2.3/sec라는 결과가 나왔다.</p>\n<p>TPS는 <code class=\"language-text\">요청개수 / 처리시간(초)</code> 로 계산되며 위 경우 요청 개수가 1개이므로 1개의 요청을 처리하는데 약 0.4초가 걸린다고 볼 수 있다.\n(원래는 네트워크 상태에 의한 지연도 고려해야하지만 지금은 고려하지않는다)</p>\n<h4>TPS를 기준으로 목표 지표 생각해보기</h4>\n<p>현재 실 서비스의 접속량을 기반으로 다음과 같이 서비스에 요구되는 TPS를 생각해봤다.</p>\n<ul>\n<li>1분당 접속자수: 0.3명</li>\n<li>평균 접속 유지시간: 1분</li>\n<li>(예상) 트래픽이 몰릴 경우 1분에 1명 꼴로 예상</li>\n</ul>\n<p>TPS = 동시 활성 사용자수 / 평균 응답 시간</p>\n<p>동시 활성 사용자수 = 1</p>\n<p>평균 응답 시간 = 0.4s</p>\n<p>목표 TPS = 4</p>\n<blockquote>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/f529b6fee03addcc4cf583726333be51/1263b/86d97246.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADy0lEQVR42p2Ub0xVdRjHn8O9QLfwcvkzQZ2Xe8853Nt6p75xaq0hS3lhbdadmq1ZyaSp+OcFQ60QUBtgzH8TKSk3EBVNJCMia+bgxkUuIAqRul6krMhqttARnXN+355zriCOcKyz/facnXN+n+f7PL/veYgmuUAkBQJkM5d5T//3QgFF0SQAgCTUcYLIN1OAmRsQgeVmknvjYtr2dgYdLno1et6DTx5JZMHxGPVAwNZfk5JbuCK6kUG/MRAbMwj5L9mGfvl89hfoUuuN75RiBNPm4CLZR1szAcoPrBJwRc0/nheH7EVkrGdQ6ZpYfc/qGG3NfBI1edOAfh/Qq0IPyf/obXK30eYtG25VlfGMsZsRM+s19f7X5clia5akrWd1Ja8/IY5ujhMbMiVsWmIzhoOygWvpuuhl8HWfwE9+oFsdRFBePNqCh+q65Cr0pwNdijb0rQdXj81A9nOEgzlP4sfTs9BXPQODjW5c+SQV35Qnob7IJU7kO7XBZjdYyD2txZv5sOSwL1mElV/RqcIIKcKMXD5+Pj8bdy+kAd/7cGany0qQ8zzhrUWENxdIWPY0oTY/XscPPuhheQCtHj89UJfFDQfaFSEuK0CHwn1SLNhIq8wKfDj/fiK2LJWQt8yGtQzcmmXDuSIX7jSxwrCio9eqrjkCvOzNRE8EaIQigC9LkywlBYFonNjuRPfHqeL3Zre4x+04sM6Bhl0JlnLByXkfYArpVLSxskWnUoO+dFOZYZYbPJiMTUujkP0sYeXcSJk7lttRuy0eHR+liKGLnkhrelhZWIXgigwWRKMeQos7Ad1KH67yyyqHjsN2/NU0S/Tw4Zza4UTBK3YLvsqEL2RvvhiFqs1xaK+cjvuXvBEwJxhzvBVDnhcYquHDWKCQBM4mAjefYe/58XebKnprZ4q691yicGWMWJchYdU8whsLCO+8bEfdu/H446s0TDR3p5qDY08Z2M2PjsQK43QijJPcr1Mu4Ew8R6cYqXSIG2UOUV/ows6AHWtZuXninxUn6I9MF6uX1eREOQ3gAwaWkIE9HM3FCUQRr2K+54hDdraWIoZbvLrZ08bdCbh7yYOJwP0Ui73UgQreVM7AfRJEKemoiNFQ6zRwnFfNNM1oSjGsQ2EP8mGaf9CfbL1PJ0wbK5aRV5RQNYNuYa90G/v41TkncMNvWQU3/QJ9HEPyHbZMpRb0LBm4MDOp4HFjzZx5XLYDhygVuygXDckV7LVmtMsNCCn70eZ9jf/h6eOrm3ROWnNxikPUPMyxSTOlDWTB7eMTMMAcrLb/2vAvwz2ECDyipTIAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='86d97246' title='' src='/static/f529b6fee03addcc4cf583726333be51/ca1dc/86d97246.png' srcset='/static/f529b6fee03addcc4cf583726333be51/e7570/86d97246.png 170w,\n/static/f529b6fee03addcc4cf583726333be51/f46e7/86d97246.png 340w,\n/static/f529b6fee03addcc4cf583726333be51/ca1dc/86d97246.png 680w,\n/static/f529b6fee03addcc4cf583726333be51/1263b/86d97246.png 1000w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n위에서 이야기했다시피 현재 Tomcat의 기본 사양으로 충~분한 요청이다.</p>\n</blockquote>\n<h3>What if..?</h3>\n<p>만약 서비스가 인기가 많아져서 요청이 많이 발생한다고 가정해보자</p>\n<h4>시나리오</h4>\n<p>사용자 유치 목표 100명의 2배인 200명의 충성고객을 유치했다고 가정한다.\n해당 고객들은 매일같이 서비스를 열정적으로 이용한다.\n<code class=\"language-text\">스레드 수: 200</code></p>\n<p>검색기능의 접근성이 단순한 점과 트래픽이 몰리는 경우를 상정하여 1초에 최대 200건의 요청이 들어온다고 가정한다.\n<code class=\"language-text\">Ramp up 시간: 1</code></p>\n<p>각 사용자는 10회 반복요청을 보낸다.\n<code class=\"language-text\">루프 카운트: 10</code></p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/52ae0bfc14dd9ec5a0f861bc21f42cba/07035/8c7c5612.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 83.52941176470588%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACnUlEQVR42q2T3U4TQRTHlzt9BZW7VUO3oR+UEtrd7uz3bGsBUbnBK57AAAGKKMSCqBASo4nxSvSSl+AlNCGppknVRi64MjFF6RzPGbokJLTeOMkvZz7O+e9/ZnaUxt7e5Z/fPjn1r5/Dev2A12oH/LDZQOr8sFHnzXqNNxCaa+K4UfvIjw4bcnwk85q8ibU/vn/x9vf3LynPHqxor15vtDa3lmF7fUO83HkOS0sVWKgsweLqAlSrVdhcX4Pq6iKsP1mGtac7MDs3D/Nzc1CpLMOjh7Pi8UoFtl5sn8xMz9xUrl7XEsN26dgqjkHW5CKlu6CmcpDNF8D2fXB9DobJIKfrkDMMyJkOjOR0JI8YMJrPi1Ed5w2zraqxmHIjHh80LLd1Z+o+lCfvCuaFYPkhOChUHr+NTEBQLIEflsDjRYRjvyjHfhhSX1DfDXg7mUzGlHgqNWg5fmvq3jSMTUwK5nhg2i5YGANMJLHSrXHp1HZ9ieMFct3FaFqOKDAbd2G1Y9gUTdMSDB3yYpmKBCYAJTDbkYXUj6A1guEHTcuW0TBtgWKgF1hbJcF4PDWYN8wWTtCkXCSo0Mct+kFRunP8AN15Zy5t7wxhk2PXa8fkllFQN1irY/ucIG3ZC/DM0L1Xwm3jxV2AcHHNCcudM+whSM44nWOpDMwNwXT4RQiKBTvAM+whSGMSJJd0AfTrdEFQ1Avm6RlqWjLRTZB1LujUsd0NQbHAOrfcy2FENNeF87fcy+E/hC4WjONL0Q3zF/2YesH6gwsnBI5Pon5vZA3Wst9SEK86wWzv2PHoJQQCoSifXi+ivKgGX1t7YCChKaqqXkumM2+S6aEPqaHMO2SXyGRHdrMjo12J8mRNOvM+PTT8tr+//4qCrU/5f63vLyptL4zh89n9AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='8c7c5612' title='' src='/static/52ae0bfc14dd9ec5a0f861bc21f42cba/ca1dc/8c7c5612.png' srcset='/static/52ae0bfc14dd9ec5a0f861bc21f42cba/e7570/8c7c5612.png 170w,\n/static/52ae0bfc14dd9ec5a0f861bc21f42cba/f46e7/8c7c5612.png 340w,\n/static/52ae0bfc14dd9ec5a0f861bc21f42cba/ca1dc/8c7c5612.png 680w,\n/static/52ae0bfc14dd9ec5a0f861bc21f42cba/02d09/8c7c5612.png 1020w,\n/static/52ae0bfc14dd9ec5a0f861bc21f42cba/9d567/8c7c5612.png 1360w,\n/static/52ae0bfc14dd9ec5a0f861bc21f42cba/07035/8c7c5612.png 2496w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>위 시나리오를 기준으로 요청을 보내본다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/3e668ccad01a4ce7d5cbfdac2a2d8cba/b7c46/eba81d9d.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 7.0588235294117645%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAOElEQVR42h2KyREAIAwCLU7Nrf1Xg4YHw7Ds8DzY6lhiUE+2WGBuZZr1b9+jEwmLotOM/Xd7URcPxS4lHUZy4y0AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='eba81d9d' title='' src='/static/3e668ccad01a4ce7d5cbfdac2a2d8cba/ca1dc/eba81d9d.png' srcset='/static/3e668ccad01a4ce7d5cbfdac2a2d8cba/e7570/eba81d9d.png 170w,\n/static/3e668ccad01a4ce7d5cbfdac2a2d8cba/f46e7/eba81d9d.png 340w,\n/static/3e668ccad01a4ce7d5cbfdac2a2d8cba/ca1dc/eba81d9d.png 680w,\n/static/3e668ccad01a4ce7d5cbfdac2a2d8cba/02d09/eba81d9d.png 1020w,\n/static/3e668ccad01a4ce7d5cbfdac2a2d8cba/9d567/eba81d9d.png 1360w,\n/static/3e668ccad01a4ce7d5cbfdac2a2d8cba/b7c46/eba81d9d.png 2162w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>TPS가 231.1/sec라는 결과가 나왔다.</p>\n<p>NIO방식으로 동작하기 때문에 TPS가 200을 넘어가는 것으로 예상된다.</p>\n<blockquote>\n<p>NIO에 대한 자세한 이야기는 여기에서 다루지는 않겠다.</p>\n</blockquote>\n<h2>결론</h2>\n<p>Tomcat의 기본 설정값으로 사용자 트래픽을 충분히 감당할 수 있을 것으로 판단했기 때문에 현재로서는 Tomcat의 스레드 설정을 기본 값으로 유지한다.</p>\n<h2>Reference</h2>\n<ul>\n<li><a href=\"https://junuuu.tistory.com/799\">https://junuuu.tistory.com/799</a></li>\n<li><a href=\"https://hudi.blog/tomcat-tuning-exercise/\">https://hudi.blog/tomcat-tuning-exercise/</a></li>\n</ul>","frontmatter":{"title":"톰캣 스레드 설정하기","date":"September 20, 2023","update":"September 20, 2023","tags":["tomcat","thread"],"series":null},"fields":{"slug":"/tomcat-thread-config/","readingTime":{"minutes":8.455}}},"seriesList":{"edges":[{"node":{"id":"28f1d87e-d3fc-5567-8531-57649652864f","fields":{"slug":"/sprint-idea/"},"frontmatter":{"title":"구글 스프린트 기반 아이디어 도출"}}},{"node":{"id":"4a9246fb-171b-5973-88fc-864034e78afd","fields":{"slug":"/blog-starter/"},"frontmatter":{"title":"피움 블로그 생성과정"}}},{"node":{"id":"c826ce0e-1ea7-517c-8d19-84e90a59a798","fields":{"slug":"/jenkins-setting/"},"frontmatter":{"title":"젠킨스 설치하기"}}},{"node":{"id":"a387bf4f-567f-50e7-b6a7-99a1a1c8971b","fields":{"slug":"/jpa-notnull-nullable/"},"frontmatter":{"title":"@NotNull과 nullable = false는 어떤 차이가 있을까?"}}},{"node":{"id":"a78e224b-b711-5071-8e90-013d6f4bebc3","fields":{"slug":"/pium-deploy-step/"},"frontmatter":{"title":"피움의 배포과정"}}},{"node":{"id":"ce07fbab-1ed5-5f1e-8e2f-eb430879b56a","fields":{"slug":"/fe-tanstack-query/"},"frontmatter":{"title":"프론트엔드: Tanstack Query 사용에 대하여"}}},{"node":{"id":"159c943b-1a50-57dd-aa71-7557364752a5","fields":{"slug":"/ci-cd-setting/"},"frontmatter":{"title":"Jenkins와 Github Webhook을 이용해 CI/CD 구축하기"}}},{"node":{"id":"dea45a4a-bfde-5fbb-8a97-42d3a3e77a0b","fields":{"slug":"/jenkins-hook-by-label/"},"frontmatter":{"title":"PR 라벨로 젠킨스 빌드유발을 구분하기"}}},{"node":{"id":"707f8ffb-1409-5c27-b15a-5661b235c226","fields":{"slug":"/db-drop-stop/"},"frontmatter":{"title":"Table Drop 못하게 막아버리기"}}},{"node":{"id":"1a03734e-d413-553f-9152-1dad2fc4acca","fields":{"slug":"/apply-https/"},"frontmatter":{"title":"내 서버에 HTTPS 설정하기"}}},{"node":{"id":"cecbc8b9-db00-562b-aa0b-06c406cfc44a","fields":{"slug":"/bundle-analyze/"},"frontmatter":{"title":"bundle-analyze를 통한 bundle 크기 분석"}}},{"node":{"id":"fe4b591a-4dd5-5dd2-b18a-b318afd1e9e3","fields":{"slug":"/transactional-not-in-restassured/"},"frontmatter":{"title":"[트러블슈팅] @SpringbootTest의 RANDOM_PORT 환경에서 @Transactional 어노테이션을 사용했을 때, RestAssured GET 요청이 수행되지 않는 경우(트랜잭션 격리 이해하기)"}}},{"node":{"id":"80aa708e-ef8a-5c79-9644-cb8c04d55a63","fields":{"slug":"/acceptance-test-resolve/"},"frontmatter":{"title":"인수테스트 데이터 초기화하기"}}},{"node":{"id":"15def1d5-c20f-5d07-b46e-24a14661365f","fields":{"slug":"/react-setting-without-cra/"},"frontmatter":{"title":"webpack으로만 React 설정하기 (without CRA)"}}},{"node":{"id":"66383c86-e2c8-533a-90e0-2effae572742","fields":{"slug":"/stylelint-and-husky/"},"frontmatter":{"title":"stylelint와 husky를 통해 컨벤션 통일하기"}}},{"node":{"id":"ed5951d5-beda-5a8f-adb2-07c2fcb38d5e","fields":{"slug":"/OAuth2.0/"},"frontmatter":{"title":"내가 이해한 OAuth2.0"}}},{"node":{"id":"45eeb9a3-557d-5704-8fd9-925283e1e27b","fields":{"slug":"/restdocs-start/"},"frontmatter":{"title":"RestDocs로 API 문서화하기"}}},{"node":{"id":"663b560a-734d-51a9-a6dc-3c4f50716c74","fields":{"slug":"/spring-event-apply/"},"frontmatter":{"title":"Spring Event 적용하기"}}},{"node":{"id":"503e9e71-eda3-53d7-8142-7c309faf213e","fields":{"slug":"/why_we_applied_querydsl/"},"frontmatter":{"title":"피움 서비스의 Querydsl 도입 이유"}}},{"node":{"id":"55ae8038-3f65-5a59-8db3-c7405e7fc125","fields":{"slug":"/github-actions-cypress/"},"frontmatter":{"title":"피움 Cypress 자동화 구축기"}}},{"node":{"id":"709124d0-5b05-5530-804d-e90ec9856a13","fields":{"slug":"/querydsl_apply_procedure/"},"frontmatter":{"title":"피움 서비스의 Querydsl 적용 과정"}}},{"node":{"id":"5c865dcb-cefd-58be-8968-b5edf6c8080c","fields":{"slug":"/server-logging/"},"frontmatter":{"title":"Logback을 이용해 운영 환경 별 로그 남기기"}}},{"node":{"id":"8269f166-d041-533c-9d44-332d8d8c3dca","fields":{"slug":"/server-monitoring/"},"frontmatter":{"title":"CloudWatch를 이용한 모니터링 환경 구성"}}},{"node":{"id":"0faec7ad-3bd1-5f5e-9222-115f771df8ed","fields":{"slug":"/tanstack-query-cache-trouble-shooting/"},"frontmatter":{"title":"InfinityQuery에서 fetch가 제대로 이루어지지 않는다?!?!"}}},{"node":{"id":"c77f7199-7fc6-53a3-a1fb-0792e05655a7","fields":{"slug":"/OAuth2.0-backend/"},"frontmatter":{"title":"OAuth 2.0 로그인 구현하기 (카카오)"}}},{"node":{"id":"12e4480d-386b-5d0e-bd69-4209fed36066","fields":{"slug":"/OAuth-test-backend/"},"frontmatter":{"title":"외부 API 를 의존하는 OAuth 로그인 테스트하기"}}},{"node":{"id":"ff40e109-cc92-5d83-a213-ca9d07136d95","fields":{"slug":"/aws-s3-apply/"},"frontmatter":{"title":"AWS S3로 정적 이미지 배포하기"}}},{"node":{"id":"e343af80-72dd-5173-bbb5-5069a17d1200","fields":{"slug":"/search_in_spring_data_jpa/"},"frontmatter":{"title":"Spring Data Jpa를 활용한 검색 기능 개발하기"}}},{"node":{"id":"af344dd8-ea77-5fde-9452-a97952ce60be","fields":{"slug":"/submodule-apply/"},"frontmatter":{"title":"Git submodule을 이용한 민감정보 관리"}}},{"node":{"id":"08c9daf0-2344-52a9-8c68-31ac04c24ff0","fields":{"slug":"/tomcat-thread-config/"},"frontmatter":{"title":"톰캣 스레드 설정하기"}}},{"node":{"id":"eafed74f-ff11-5af1-a589-e9dd2ccb5c8e","fields":{"slug":"/http-cache/"},"frontmatter":{"title":"CloudFront와 HTTP 캐시"}}},{"node":{"id":"dbe47289-01f4-571d-9506-fbb92016f547","fields":{"slug":"/optimize-frontend/"},"frontmatter":{"title":"피움 최적화하기"}}},{"node":{"id":"7b830fe6-e2df-564a-926e-7f7800380336","fields":{"slug":"/query-analysis/"},"frontmatter":{"title":"서비스 내에서 발생하는 쿼리를 분석하고 개선하기"}}},{"node":{"id":"37437d15-a63e-52ef-b031-6ee1bc6fa8bc","fields":{"slug":"/image-resize/"},"frontmatter":{"title":"서버에서 이미지 리사이징하기"}}},{"node":{"id":"216f4636-4125-5765-83d8-a6a610692a41","fields":{"slug":"/dont-stop-deploy/"},"frontmatter":{"title":"무중단 배포 환경 구성하기"}}},{"node":{"id":"dd095976-5a96-51b5-9686-8956dc60cd24","fields":{"slug":"/hikaricp-connection-pool-setting/"},"frontmatter":{"title":"HikariCp Connection Pool 값 설정"}}},{"node":{"id":"625ad76f-acb1-56cc-9baa-3d6f1a954ac2","fields":{"slug":"/pwa/"},"frontmatter":{"title":"PWA를 도입해보자"}}},{"node":{"id":"6a12651c-e6b8-5fa6-9c57-766772d32680","fields":{"slug":"/serviceworker/"},"frontmatter":{"title":"Service Worker에 대한 대략적인 이해"}}},{"node":{"id":"b9709447-61dc-52f0-95a5-8670a3fbaaf4","fields":{"slug":"/installPrompt/"},"frontmatter":{"title":"홈화면에 추가 안내 prompt 만들기"}}},{"node":{"id":"ac7012e4-5b85-5040-b65e-c068968d7979","fields":{"slug":"/web-push/"},"frontmatter":{"title":"브라우저에서 알림 구현하기"}}}]},"previous":{"fields":{"slug":"/submodule-apply/"},"frontmatter":{"title":"Git submodule을 이용한 민감정보 관리"}},"next":{"fields":{"slug":"/http-cache/"},"frontmatter":{"title":"CloudFront와 HTTP 캐시"}}},"pageContext":{"id":"08c9daf0-2344-52a9-8c68-31ac04c24ff0","series":null,"previousPostId":"af344dd8-ea77-5fde-9452-a97952ce60be","nextPostId":"eafed74f-ff11-5af1-a589-e9dd2ccb5c8e"}},"staticQueryHashes":[],"slicesMap":{}}